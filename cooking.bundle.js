(()=>{"use strict";var e,t,n={48:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o,eventBus:()=>r});const i=new Map,r={subscribe:function(e,t){i.has(e)||i.set(e,new Set);const n=i.get(e);return n.add(t),()=>{n.delete(t),0===n.size&&i.delete(e)}},unsubscribe:function(e,t){if(!i.has(e))return!1;const n=i.get(e),r=n.delete(t);return 0===n.size&&i.delete(e),r},publish:function(e,t){i.has(e)&&i.get(e).forEach((n=>{try{n(t)}catch(t){console.error(`Error in event handler for ${e}:`,t)}}))},hasSubscribers:function(e){return i.has(e)&&i.get(e).size>0},clear:function(e){e?i.delete(e):i.clear()}};window.eventBus=r;const o=r},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var c=e[a],l=i.base?c[0]+i.base:c[0],d=o[l]||0,m="".concat(l," ").concat(d);o[l]=d+1;var p=n(m),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var h=r(u,i);i.byIndex=a,t.splice(a,0,{identifier:m,updater:h,references:1})}s.push(m)}return s}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var c=i(e,r),l=0;l<o.length;l++){var d=n(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},107:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Flexbox utilities */\n.flex {\n  display: flex;\n}\n\n.flex-col {\n  flex-direction: column;\n}\n\n.items-center {\n  align-items: center;\n}\n\n.justify-center {\n  justify-content: center;\n}\n\n.justify-between {\n  justify-content: space-between;\n}\n\n/* Spacing utilities */\n.m-0 { margin: 0; }\n.p-0 { padding: 0; }\n\n.mt-1 { margin-top: var(--spacing-xs); }\n.mt-2 { margin-top: var(--spacing-sm); }\n.mt-3 { margin-top: var(--spacing-md); }\n.mt-4 { margin-top: var(--spacing-lg); }\n\n.mb-1 { margin-bottom: var(--spacing-xs); }\n.mb-2 { margin-bottom: var(--spacing-sm); }\n.mb-3 { margin-bottom: var(--spacing-md); }\n.mb-4 { margin-bottom: var(--spacing-lg); }\n\n/* Text utilities */\n.text-center {\n  text-align: center;\n}\n\n.text-primary {\n  color: var(--color-primary);\n}\n\n.text-secondary {\n  color: var(--color-secondary);\n}\n\n/* Container */\n.container {\n  width: 100%;\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 var(--spacing-md);\n}\n\n/* Card styles */\n.card {\n  background: var(--color-white);\n  border-radius: var(--border-radius-md);\n  padding: var(--spacing-md);\n  box-shadow: var(--shadow-sm);\n}\n\n/* Button base styles */\n.btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: var(--spacing-sm) var(--spacing-md);\n  border-radius: var(--border-radius-sm);\n  font-size: var(--font-size-sm);\n  font-weight: 500;\n  text-decoration: none;\n  cursor: pointer;\n  transition: all var(--transition-fast);\n}\n\n.btn-primary {\n  background-color: var(--color-primary);\n  color: var(--color-white);\n}\n\n.btn-secondary {\n  background-color: var(--color-secondary);\n  color: var(--color-white);\n}",""]);const a=s},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},165:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s,runTimerTests:()=>r});var i=n(48);function r(){console.log("--- RUNNING AUTOMATED TIMER TESTS ---");const e=new Set,t=new Map;let n=!1,r=!1;!function(){const e=document.createElement("div");e.id="timer-test-results",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.width="400px",e.style.maxHeight="300px",e.style.overflowY="auto",e.style.backgroundColor="rgba(245, 245, 245, 0.95)",e.style.border="1px solid #ccc",e.style.borderRadius="5px",e.style.padding="10px",e.style.zIndex="1000",e.style.fontFamily="monospace",e.style.fontSize="12px";const t=document.createElement("h3");t.textContent="Timer Tests",t.style.margin="0 0 10px 0",t.style.padding="0 0 5px 0",t.style.borderBottom="1px solid #ccc",e.appendChild(t);const n=document.createElement("div");n.id="timer-test-logs",e.appendChild(n),document.body.appendChild(e)}(),i.default.subscribe("timer:created",(i=>{console.log(`Timer created event received: ${i.timer.id}, name: ${i.timer.name}`),t.set(i.timer.id,i.timer),e.has(i.timer.id)?(console.error(`DUPLICATE TIMER DETECTED: ${i.timer.id}`),o("error",`Duplicate timer detected: ${i.timer.id}`),n=!0):(e.add(i.timer.id),console.log(`Added timer ${i.timer.id} to tracking list`),o("info",`Timer created: ${i.timer.name} (${i.timer.id})`)),i.timer.name&&"Timer"!==i.timer.name&&"undefined"!==i.timer.name?(console.log(`Timer name verified: "${i.timer.name}"`),o("success",`Timer name verified: "${i.timer.name}"`)):(console.error(`INVALID TIMER NAME: "${i.timer.name}" for timer ${i.timer.id}`),o("error",`Invalid timer name: "${i.timer.name}" for timer ${i.timer.id}`),r=!0)})),setTimeout((()=>{const e=document.querySelectorAll(".timer-step-indicator"),t=document.body.dataset.currentStepId;if(t?o("info",`Current step ID: ${t}`):o("error","Current step ID not set on document.body"),0===e.length)o("error","No step indicators found");else{const t=document.querySelectorAll(".timer-step-indicator.current");o("info",`Found ${e.length} step indicators, ${t.length} are marked as current`)}}),2e3),setTimeout((()=>{console.log("--- TIMER TEST RESULTS ---"),console.log(`Total timers created: ${e.size}`),o("heading","Timer Test Results"),o("info",`Total timers created: ${e.size}`),n?(console.error("TEST FAILED: Duplicate timers detected"),o("error","TEST FAILED: Duplicate timers detected")):(console.log("TEST PASSED: No duplicate timers detected"),o("success","TEST PASSED: No duplicate timers detected")),r?(console.error("TEST FAILED: Invalid timer names detected"),o("error","TEST FAILED: Invalid timer names detected")):(console.log("TEST PASSED: All timer names are valid"),o("success","TEST PASSED: All timer names are valid")),console.log("--- END TIMER TESTS ---")}),5e3)}function o(e,t){const n=document.getElementById("timer-test-logs");if(!n)return;const i=document.createElement("div");switch(i.style.marginBottom="5px",i.style.padding="5px",i.style.borderRadius="3px",e){case"info":i.style.backgroundColor="#f0f0f0";break;case"success":i.style.backgroundColor="#dff0d8",i.style.color="#3c763d";break;case"error":i.style.backgroundColor="#f2dede",i.style.color="#a94442";break;case"heading":i.style.fontWeight="bold",i.style.borderBottom="1px solid #ccc",i.style.paddingBottom="5px"}i.textContent=t,n.appendChild(i),n.scrollTop=n.scrollHeight}n(281);const s={runTimerTests:r}},249:(e,t,n)=>{n.d(t,{A:()=>x});var i=n(601),r=n.n(i),o=n(314),s=n.n(o),a=n(330),c=n(107),l=n(694),d=n(668),m=n(269),p=n(343),u=n(567),h=n(605),g=n(763),v=n(949),b=n(433),f=n(319),y=s()(r());y.i(a.A),y.i(c.A),y.i(l.A),y.i(d.A),y.i(m.A),y.i(p.A),y.i(u.A),y.i(h.A),y.i(g.A),y.i(v.A),y.i(b.A),y.i(f.A),y.push([e.id,"/* Base Styles */\n\n/* Import Layout Styles */\n\n/* Components */ ",""]);const x=y},258:(e,t,n)=>{n.d(t,{C$:()=>c,Kk:()=>l,Tj:()=>u,XW:()=>a,_w:()=>g,fN:()=>d,kB:()=>p});var i=n(548);const r=["bake","boil","simmer","roast","grill","fry","sauté","steam","cook","heat","mix","stir","blend","whip","knead","rest","marinate","chill","freeze","thaw","prepare","microwave","preheat","broil","sear","toast","caramelize","reduce","wait","let","allow","cool","stand","set","rise","ferment","proof","season","tenderize","smoke","cure","pickle","braise","poach","blanch","infuse","render","melt","dissolve","steep","strain","cover","turn","flip","fold","sweat","deglaze"],o=["simmer","bake","roast","boil","cook","wait","let","allow","rest"],s=/(\d+(?:-\d+)?)\s*(hour|hr|hrs|minute|min|mins|second|sec|secs)/gi;function a(e,t){return`step-${e}-timer-${t}`}function c(e){if(!e||"string"!=typeof e)return 0;let t,n=0;for(s.lastIndex=0;null!==(t=s.exec(e));){const e=t[1],i=t[2].toLowerCase();let r;if(e.includes("-")){const[t,n]=e.split("-").map((e=>parseInt(e.trim(),10)));r=n||t}else r=parseInt(e,10);isNaN(r)||(i.startsWith("hour")||"hr"===i||"hrs"===i?n+=3600*r:i.startsWith("min")||"mins"===i?n+=60*r:(i.startsWith("sec")||"secs"===i)&&(n+=r))}return n}function l(e){if(!e||"string"!=typeof e)return"Timer";try{const t=e.replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim(),n=r.find((e=>new RegExp(`\\b${e}\\b`,"i").test(t)));if(n){const e=new RegExp(`\\b${n}\\b`,"i"),i=t.search(e);if(-1!==i){const e=t.substring(i).split(" ").slice(0,3).join(" ");return e.charAt(0).toUpperCase()+e.slice(1)}}const i=t.split(" ");return i.length<=4?t.charAt(0).toUpperCase()+t.slice(1):(i.slice(0,3).join(" ")+"...").charAt(0).toUpperCase()+(i.slice(0,3).join(" ")+"...").slice(1)}catch(e){return console.error("Error creating timer label:",e),"Timer"}}function d(e){if(!e)return[];const t=[],n=e.description||e.mainStep;if(n&&"string"==typeof n){const i=m(n);for(const r of i)r.seconds>0&&t.push({duration:r.seconds,label:g(n,r.index,e.title),source:"main",matchIndex:r.index,inParentheses:!0,originalText:r.text})}return e.bullets&&Array.isArray(e.bullets)&&e.bullets.forEach(((n,i)=>{if("string"==typeof n){const r=m(n);for(const o of r)o.seconds>0&&t.push({duration:o.seconds,label:g(n,o.index,e.title),source:"bullet",bulletIndex:i,matchIndex:o.index,inParentheses:!0,originalText:o.text})}})),t}function m(e){const t=[],n=/\([^)]+\)/g;let i;for(;null!==(i=n.exec(e));){const e=i[0],n=e.slice(1,-1).trim(),r=[],o=/(\d+(?:-\d+)?)\s*(hour|hr|hrs|minute|min|mins|second|sec|secs)/gi;let s;for(;null!==(s=o.exec(n));){const e=s[1],t=s[2];let n,i=0;if(e.includes("-")){const[t,i]=e.split("-").map((e=>parseInt(e.trim(),10)));n=i||t}else n=parseInt(e,10);if(!isNaN(n)){const e=t.toLowerCase();e.startsWith("hour")||"hr"===e||"hrs"===e?i=3600*n:e.startsWith("min")||"mins"===e?i=60*n:(e.startsWith("sec")||"secs"===e)&&(i=n),i>0&&r.push({value:n,unit:t,seconds:i})}}r.length>0&&t.push({text:e,content:n,index:i.index,seconds:r[0].seconds})}return t}function p(e){return(0,i.LU)(e)}function u(e,t){if(e<=0||t<0)return 0;if(0===t)return 100;const n=(e-t)/e*100;return Math.min(Math.max(0,Math.round(n)),100)}const h=["chicken","beef","pork","fish","salmon","tuna","shrimp","tofu","lamb","duck","turkey","sausage","bacon","ham","steak","ribs","chops","ground beef","ground turkey","ground pork","meatballs","tempeh","seitan","crab","lobster","scallops","eggs","onion","garlic","carrot","celery","potato","tomato","bell pepper","jalapeno","broccoli","cauliflower","spinach","kale","lettuce","cabbage","asparagus","zucchini","eggplant","squash","pumpkin","cucumber","mushroom","corn","peas","green beans","brussels sprouts","artichoke","leek","shallot","radish","turnip","beet","rice","pasta","noodles","bread","dough","flour","oats","quinoa","couscous","barley","farro","bulgur","polenta","grits","tortilla","pita","bagel","beans","lentils","chickpeas","black beans","kidney beans","pinto beans","navy beans","lima beans","edamame","split peas","milk","cream","cheese","butter","yogurt","sour cream","buttermilk","almond milk","soy milk","oat milk","coconut milk","apple","banana","orange","lemon","lime","berry","berries","strawberry","blueberry","raspberry","blackberry","cherry","grape","pear","peach","plum","pineapple","mango","kiwi","melon","watermelon","cantaloupe","basil","thyme","rosemary","oregano","parsley","cilantro","mint","dill","sage","bay leaf","cumin","coriander","paprika","turmeric","ginger","sauce","ketchup","mustard","mayonnaise","vinegar","oil","olive oil","salsa","soy sauce","marinara","gravy","dressing","glaze","mixture","batter","stock","broth","soup","stew","casserole","filling","frosting","icing","syrup","caramel","roux","crust","seasoning","nuts","almonds","walnuts","pecans","cashews","pistachios","seeds","sesame","sunflower","pumpkin seeds","flax","chia"];function g(e,t,n){if(!e||"string"!=typeof e)return"Timer";try{const n=200,i=Math.max(0,t-n),s=e.substring(i,t).trim(),a=e.substring(t).trim(),c=(s+" "+a).replace(/[.,()]/g," ").replace(/\s+/g," ").toLowerCase().trim();if(c.split(" "),/\b(wait|let\s+rest|let\s+stand|allow\s+to\s+rest|allow\s+to\s+sit)\b/i.test(s))return"Wait timer";const l=[];for(const e of r)new RegExp(`\\b${e}\\b`,"i").test(s)&&l.push(e.toLowerCase());let d=null;for(const e of o)if(l.includes(e)){d=e;break}if(!d&&l.length>0){let e=null,n=1/0;for(const r of l){const o=s.toLowerCase().lastIndexOf(r);if(-1!==o){const s=t-i-o;s<n&&(n=s,e=r)}}d=e}if(!d)return"Timer";"cooking"===d||"cooks"===d||"cooked"===d?d="cook":"baking"===d||"bakes"===d||"baked"===d?d="bake":"simmering"===d||"simmers"===d||"simmered"===d?d="simmer":"waiting"!==d&&"waits"!==d&&"waited"!==d||(d="wait");const m=[];for(const e of h)new RegExp(`\\b${e}\\b`,"i").test(c)&&(m.some((t=>t.includes(e)||e.includes(t)))||m.push(e.toLowerCase()));let p=null;if(m.length>0){const e=s.toLowerCase().lastIndexOf(d);if(-1!==e){const t=(s.substring(e)+" "+a.substring(0,50)).toLowerCase();let n=null,i=1/0;for(const e of m){const r=t.indexOf(e);-1!==r&&r<i&&(i=r,n=e)}p=n}p||(p=m[0])}return"add"===d&&s.toLowerCase().includes("cook")&&(c.includes("pork")||c.includes("steak")||c.includes("chicken")||c.includes("meat"))&&(d="cook"),"add"===d&&s.toLowerCase().includes("simmer")&&(d="simmer"),p?`${d.charAt(0).toUpperCase()+d.slice(1)} ${p}`:`${d.charAt(0).toUpperCase()+d.slice(1)} timer`}catch(e){return console.error("Error generating timer name:",e),"Timer"}}},269:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Header Styles */\nheader {\n    text-align: center;\n    margin-bottom: var(--spacing-xxl);\n    padding-bottom: var(--spacing-lg);\n    border-bottom: 1px solid #e0e0e0;\n}\n\n.site-title {\n    color: var(--color-primary);\n    font-size: var(--font-size-title);\n    margin-bottom: var(--spacing-sm);\n}\n\n.site-description {\n    color: var(--color-text-light);\n    font-size: var(--font-size-lg);\n}\n\n/* Back Button */\n.back-button {\n    display: inline-block;\n    margin-bottom: var(--spacing-lg);\n    color: var(--color-primary);\n    text-decoration: none;\n    font-size: var(--font-size-base);\n}\n\n.back-button:hover {\n    text-decoration: underline;\n} ",""]);const a=s},281:(e,t,n)=>{n.d(t,{Ay:()=>s}),n(936),n(598),n(334);var i=n(48),r=n(258);const o=new class{constructor(e){this.eventBus=e||i.default,this.timerCore=null,this.timerUi=null,this.processedSteps=new Set,this.stepTimers={},this.initialized=!1}async init(e={}){try{if(this.initialized)return console.log("Timer module already initialized"),this;if(this.options={enableUi:!0,autoAdvanceOnComplete:!1,onTimerComplete:null,...e},!this.eventBus){const{default:e}=await Promise.resolve().then(n.bind(n,48));this.eventBus=e}if(e.keepExistingTimers||await this.clearAllTimers(),!this.timerCore){const{default:e}=await Promise.resolve().then(n.bind(n,598));this.timerCore=e(this.eventBus),await this.timerCore.init()}if(this.options.enableUi&&!this.timerUi){const{default:e}=await Promise.resolve().then(n.bind(n,334));this.timerUi=e(this.eventBus),await this.timerUi.init()}try{const{default:e}=await n.e(434).then(n.bind(n,434));this.timerCommandInterface=e(this.eventBus),await this.timerCommandInterface.init()}catch(e){console.log("Timer command interface not available:",e)}return this.setupEventHandlers(),this.initialized=!0,this.eventBus.publish("timer:initialized",{}),document.dispatchEvent(new CustomEvent("timer:module:ready")),"undefined"!=typeof window&&(window.timerModule=this,console.log("Timer module exposed to window.timerModule for debugging")),console.log("Timer module initialized successfully"),this}catch(e){return console.error("Error initializing timer module:",e),this}}isInitialized(){return this.initialized}setupEventHandlers(){this.eventBus.subscribe("step:changed",(e=>{e&&void 0!==e.stepId&&this.highlightStep(e.stepId)})),this.eventBus.subscribe("timer:command:process",(e=>{if(e&&e.command&&this.timerCommandInterface){console.log("Timer module received command to process:",e.command);try{const t=this.timerCommandInterface.processCommand(e.command);if(console.log("Timer command processing result:",t?"Successful":"Failed"),!t){const t=e.command.match(/start\s+(?:the\s+)?(.+?)(?:\s+timer)?/i);if(t&&t[1]){const e=t[1].toLowerCase(),n=e.endsWith(" timer")?e:e+" timer";console.log(`Trying direct timer start for: "${e}" or "${n}"`);const i=this.timerCore.getAllTimers();console.log("Available timers:",Object.keys(i).map((e=>i[e].name)));let r=!1;const o=Object.keys(i);for(const t of o){const o=i[t],s=o.name.toLowerCase();(s.includes(e)||e.includes(s)||s===n.toLowerCase())&&(console.log(`Found matching timer: ${o.name}, starting it directly`),this.eventBus.publish("timer:request:start",{id:t}),r=!0)}return r||console.log(`No timer found matching name: ${e} or ${n}`),r}}}catch(e){console.error("Error processing timer command:",e)}}else console.log("Invalid timer command data received:",e)})),this.eventBus.subscribe("timer:request:list:all",(e=>{console.log("Received request to list all timers");const t=this.getAllTimers(),n=Object.entries(t).map((([e,t])=>({id:e,name:t.name,duration:t.duration,status:t.status})));console.log("Available timers:",n),e&&"function"==typeof e.callback&&e.callback(n)}))}cleanup(){this.timerCore&&this.timerCore.cleanup(),this.timerUi&&this.timerUi.cleanup(),this.stepTimers={},this.processedSteps.clear(),this.initialized=!1}createTimer(e){const t=e.metadata?.stepId,n=this._createTimerSignature(e);if(void 0!==t){const e=`step-${t}`;if(this.stepTimers[e]||(this.stepTimers[e]=new Set),this.stepTimers[e].has(n))return console.log(`Skipping duplicate timer: ${n} for step ${e}`),Promise.resolve(null);this.stepTimers[e].add(n)}return console.log("Timer module creating timer with data:",e),void 0!==t&&(document.body.dataset.currentStepId=t.toString(),e.metadata?.stepPhase&&(document.body.dataset.currentPhase=e.metadata.stepPhase),e.metadata?.phaseStepNumber&&(document.body.dataset.currentPhaseStepNumber=e.metadata.phaseStepNumber.toString())),this.eventBus.publish("timer:request:create",e),new Promise((t=>{let n=null;const i=setTimeout((()=>{console.warn(`Timer creation timeout for ${e.name}`),n&&"function"==typeof n?n():this.eventBus.unsubscribe&&this.eventBus.unsubscribe("timer:created:response",r),t(null)}),3e3),r=e=>{clearTimeout(i),e&&e.id?t(e.id):t(null),n&&"function"==typeof n?n():this.eventBus.unsubscribe&&this.eventBus.unsubscribe("timer:created:response",r)};this.eventBus.subscribeOnce?n=this.eventBus.subscribeOnce("timer:created:response",r):this.eventBus.subscribe("timer:created:response",r)}))}async createTimersForStep(e,t){if(!this.initialized)return console.error("Timer module not initialized. Call initialize() first."),Promise.resolve([]);if(!e)return console.error("Invalid step provided to createTimersForStep"),[];const{stepIndex:n,phase:i,phaseStepNumber:o}=t,s=`${i}-step-${n}`;if(this.processedSteps.has(s))return console.log("Step already processed, skipping timer detection"),[];this.processedSteps.add(s);try{const t=`${"preparation"===i?"Preparation":"Cooking"} Step ${o}`,s=r.fN(e);console.log(`Found ${s.length} timers in step`,s);const a=[];for(const r of s)try{const s="main"===r.source?e.description:e.bullets[r.bulletIndex],c=this.createTimer({name:r.label||t,duration:r.duration,metadata:{stepId:n,stepIndex:n,stepPhase:i,phaseStepNumber:o,source:r.source,bulletIndex:r.bulletIndex,matchIndex:r.matchIndex,stepTitle:t,sourceText:s}});a.push(c)}catch(e){console.error("Error creating timer:",e)}const c=await Promise.all(a);return console.log(`Created ${c.filter((e=>null!==e)).length} timers for step ${n}`),c.filter((e=>null!==e))}catch(e){return console.error("Error processing timers for step:",e),[]}}clearProcessedSteps(){this.processedSteps.clear(),this.stepTimers={}}_createTimerSignature(e){const t=e.metadata?.stepId||"unknown",n=e.duration||0;return`${t}-${e.metadata?.source||"unknown"}-${void 0!==e.metadata?.bulletIndex?e.metadata.bulletIndex:-1}-${void 0!==e.metadata?.matchIndex?e.metadata.matchIndex:-1}-${n}`}startTimer(e){this.eventBus.publish("timer:request:start",{id:e})}pauseTimer(e){this.eventBus.publish("timer:request:pause",{id:e})}resetTimer(e){this.eventBus.publish("timer:request:reset",{id:e})}removeTimer(e){this.eventBus.publish("timer:request:remove",{id:e})}getTimer(e){return this.timerCore?this.timerCore.getTimer(e):null}getAllTimers(){return this.timerCore?this.timerCore.getAllTimers():[]}clearAllTimers(){console.log("Timer module: clearAllTimers called");try{return this.timerCore&&"function"==typeof this.timerCore.clearAllTimers?this.timerCore.clearAllTimers():this.eventBus.publish("timer:request:clear",{}),this.stepTimers={},this.processedSteps.clear(),document.dispatchEvent(new CustomEvent("timers:all:cleared")),console.log("All timers cleared completely from the timer module"),!0}catch(e){return console.error("Error clearing all timers:",e),!1}}renameTimer(e,t){this.eventBus.publish("timer:request:rename",{id:e,name:t})}addMetadata(e,t){this.eventBus.publish("timer:request:addMetadata",{id:e,metadata:t})}highlightStep(e){null!=e&&(document.body.dataset.currentStepId=e.toString(),this.eventBus.publish("timer:request:highlightStep",{stepId:e}),this.timerUi)&&(document.querySelectorAll(".timer").forEach((t=>{const n=t.dataset.stepId;n&&(t.classList.toggle("current-step",n===e.toString()),t.classList.toggle("previous-step",n!==e.toString()&&parseInt(n)<parseInt(e)))})),document.querySelectorAll(".timer-step-indicator").forEach((t=>{t.dataset.stepId&&t.classList.toggle("current",t.dataset.stepId===e.toString())})))}},s={initialize:async(e={})=>o.init(e),isInitialized:()=>o.isInitialized(),createTimer:e=>o.createTimer(e),startTimer:e=>o.startTimer(e),pauseTimer:e=>o.pauseTimer(e),resetTimer:e=>o.resetTimer(e),removeTimer:e=>o.removeTimer(e),getTimer:e=>o.getTimer(e),getAllTimers:()=>o.getAllTimers(),clearAllTimers:()=>o.clearAllTimers(),renameTimer:(e,t)=>o.renameTimer(e,t),addMetadata:(e,t)=>o.addMetadata(e,t),highlightStep:e=>o.highlightStep(e),createTimersForStep:(e,t)=>o.createTimersForStep(e,t),clearProcessedSteps:()=>o.clearProcessedSteps(),utils:{findTimersInStep:r.fN,createStepTimerKey:r.XW,createTimerLabel:r.Kk,generateTimerName:r._w,extractDuration:r.C$,formatTimeForDisplay:r.kB,calculateCompletion:r.Tj}};"undefined"!=typeof window&&(window.timerModule=o)},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);i&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},319:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Cooking Mode Styles */\n\n/* Variables - scoped to cooking-mode */\n.cooking-mode {\n    --cooking-primary: #9D4700;\n    --cooking-secondary: #F5E6DA;\n    --cooking-text: #2C1810;\n    --cooking-background: #FFF9F5;\n    --cooking-border: #E8D5C5;\n}\n\n/* Base Layout */\n.cooking-mode .page-container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n}\n\n/* Flash feedback for button actions */\n@keyframes flash-feedback {\n    0% { background-color: var(--cooking-secondary); }\n    50% { background-color: var(--cooking-primary); }\n    100% { background-color: var(--cooking-secondary); }\n}\n\n.cooking-mode .flash-feedback {\n    animation: flash-feedback 0.3s ease-in-out;\n}\n\n/* Back Button */\n.cooking-mode .back-button {\n    color: var(--cooking-primary);\n    text-decoration: none;\n    font-size: 1.1rem;\n    display: inline-block;\n    margin-bottom: 2rem;\n}\n\n/* Main Content Container */\n.cooking-mode .main-content {\n    background: white;\n    border-radius: 12px;\n    padding: 2rem;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n}\n\n/* Progress Bar */\n.cooking-mode .cooking-progress {\n    margin-bottom: 2rem;\n}\n\n.cooking-mode .progress-bar {\n    width: 100%;\n    height: 8px;\n    background-color: var(--cooking-secondary);\n    border-radius: 4px;\n    overflow: hidden;\n    margin-bottom: 1rem;\n}\n\n.cooking-mode .progress {\n    height: 100%;\n    background-color: var(--cooking-primary);\n    transition: width 0.3s ease;\n}\n\n.cooking-mode .phase-indicators {\n    display: flex;\n    justify-content: flex-start;\n    margin-bottom: 1rem;\n}\n\n.cooking-mode .phase-indicator {\n    background: var(--cooking-secondary);\n    border: none;\n    padding: 0.5rem 1.5rem;\n    font-size: 1.1rem;\n    color: var(--cooking-text);\n    cursor: pointer;\n    border-radius: 100px;\n    transition: all 0.3s ease;\n    margin-right: 10px;\n}\n\n.cooking-mode .phase-indicator:hover {\n    background-color: #e8e8e8;\n}\n\n.cooking-mode .phase-indicator.active {\n    background-color: var(--cooking-primary);\n    color: white;\n    font-weight: 500;\n}\n\n/* Step Container */\n.cooking-mode .step-container {\n    margin-bottom: 2rem;\n}\n\n.cooking-mode .step-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n}\n\n.cooking-mode #step-title {\n    font-family: 'Prata', serif;\n    color: var(--cooking-primary);\n    font-size: 1.5rem;\n    margin: 0;\n}\n\n.cooking-mode .step-number {\n    color: var(--cooking-text);\n    font-size: 1rem;\n}\n\n/* Step Content */\n.cooking-mode .step-content {\n    margin-bottom: 2rem;\n}\n\n.cooking-mode .main-step {\n    font-size: 1.2rem;\n    color: var(--cooking-text);\n    margin-bottom: 1rem;\n}\n\n.cooking-mode .bullet-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n}\n\n.cooking-mode .bullet-list li {\n    position: relative;\n    padding-left: 1.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--cooking-text);\n}\n\n.cooking-mode .bullet-list li::before {\n    content: \"•\";\n    position: absolute;\n    left: 0;\n    color: var(--cooking-primary);\n}\n\n/* Timer Styles */\n.cooking-mode .multi-timer-container {\n    margin: 1.5rem 0;\n    padding: 0.5rem;\n    background-color: var(--cooking-background);\n    border-radius: 8px;\n    border: 1px solid var(--cooking-border);\n    max-width: 100%;\n    box-sizing: border-box;\n}\n\n.cooking-mode .multi-timer-container h3 {\n    color: var(--cooking-primary);\n    margin: 0 0 0.75rem;\n    font-size: 1.1rem;\n    font-weight: 500;\n}\n\n.cooking-mode .timer {\n    position: relative;\n    background-color: #fff;\n    border-radius: 6px;\n    margin-bottom: 0.4rem;\n    padding: 0.5rem 0.6rem;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n    border-left: 4px solid var(--cooking-secondary);\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    max-width: 100%;\n    transition: border-color 0.3s, background-color 0.3s;\n}\n\n/* Timer states */\n.cooking-mode .timer.running {\n    background-color: rgba(253, 245, 230, 0.5);\n    border-left-color: var(--cooking-primary);\n}\n\n.cooking-mode .timer.paused {\n    border-left-color: #FFC107;\n}\n\n.cooking-mode .timer.complete {\n    border-left-color: var(--cooking-primary);\n}\n\n/* Step-based timer states */\n.cooking-mode .timer.timer-current-step {\n    background-color: rgba(253, 245, 230, 0.5);\n    border-left-color: var(--cooking-primary);\n}\n\n.cooking-mode .timer.timer-previous-step {\n    opacity: 0.75;\n}\n\n.cooking-mode .timer.timer-future-step {\n    opacity: 0.9;\n}\n\n/* Timer name styles */\n.cooking-mode .timer-name-container {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n    margin-bottom: 0.4rem;\n}\n\n.cooking-mode .timer-name {\n    font-size: 0.9rem;\n    color: var(--cooking-text);\n    font-weight: 500;\n    padding: 2px 4px;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: background-color 0.2s;\n    flex: 1;\n}\n\n.cooking-mode .timer-name:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n}\n\n.cooking-mode .timer-name-input {\n    flex: 1;\n    padding: 3px 6px;\n    border: 1px solid var(--cooking-border);\n    border-radius: 4px;\n    font-family: inherit;\n    font-size: inherit;\n    margin-right: 0.5rem;\n}\n\n/* Add styling for the right controls container */\n.cooking-mode .timer-right-controls {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    margin-left: auto;\n}\n\n/* Style for the timer step indicator */\n.cooking-mode .timer-step-indicator {\n    display: inline-flex;\n    align-items: center;\n    font-size: 0.8rem;\n    color: #666;\n    padding: 2px 6px;\n    border-radius: 12px;\n    background-color: #f0f0f0;\n    white-space: nowrap;\n}\n\n.cooking-mode .timer-step-indicator.current {\n    color: var(--cooking-primary);\n    font-weight: 500;\n    background-color: rgba(157, 71, 0, 0.08);\n}\n\n.cooking-mode .current-dot {\n    color: var(--cooking-primary);\n    margin-left: 3px;\n    font-size: 0.9em;\n    position: relative;\n    top: 0.1em;\n}\n\n/* Button styles */\n.cooking-mode .timer-button {\n    background-color: var(--cooking-primary);\n    color: white;\n    border: none;\n    cursor: pointer;\n    font-size: 0.8rem;\n    font-weight: 500;\n    padding: 0.2rem 0.6rem;\n    border-radius: 4px;\n    transition: background-color 0.3s ease;\n    margin-right: 0.3rem;\n}\n\n.cooking-mode .timer-button.primary-button {\n    background-color: var(--cooking-primary);\n}\n\n.cooking-mode .timer-button.secondary-button {\n    background-color: var(--cooking-secondary);\n    color: var(--cooking-text);\n}\n\n/* New button row with integrated time display */\n.cooking-mode .timer-button-row {\n    display: flex;\n    align-items: center;\n    position: relative;\n    margin-bottom: 0.4rem;\n    flex-wrap: nowrap;\n}\n\n.cooking-mode .inline-time-display {\n    font-size: 1.1rem;\n    font-weight: 700;\n    color: var(--cooking-text);\n    position: absolute;\n    left: 50%;\n    transform: translateX(-50%);\n    text-align: center;\n}\n\n/* Only change the time display color when running/completed, not the whole box */\n.cooking-mode .timer.running .inline-time-display {\n    color: var(--cooking-primary);\n}\n\n.cooking-mode .timer.complete .inline-time-display {\n    color: var(--cooking-primary);\n}\n\n/* Progress bar */\n.cooking-mode .progress-container {\n    width: 100%;\n    height: 4px;\n    background-color: var(--cooking-secondary);\n    border-radius: 2px;\n    overflow: hidden;\n    margin: 0.2rem 0;\n}\n\n.cooking-mode .timer .progress-bar {\n    height: 100%;\n    background-color: var(--cooking-primary);\n    transition: width 1s linear;\n    width: 0;\n    border-radius: 0;\n    margin: 0;\n}\n\n/* Timer toast notification */\n.cooking-mode .timer-toast {\n    position: fixed;\n    bottom: 1rem;\n    right: 1rem;\n    background-color: var(--cooking-primary);\n    color: white;\n    padding: 0.75rem 1rem;\n    border-radius: 4px;\n    box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n    z-index: 1000;\n    transition: opacity 0.5s;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    max-width: 80%;\n}\n\n/* Timer highlight animation */\n@keyframes timer-highlight-pulse {\n    0% { box-shadow: 0 0 0 0 rgba(157, 71, 0, 0.4); }\n    70% { box-shadow: 0 0 0 10px rgba(157, 71, 0, 0); }\n    100% { box-shadow: 0 0 0 0 rgba(157, 71, 0, 0); }\n}\n\n.cooking-mode .timer-highlight {\n    animation: timer-highlight-pulse 2s infinite;\n}\n\n/* Mobile Responsiveness */\n@media (max-width: 768px) {\n    .cooking-mode .page-container {\n        padding: 1rem;\n    }\n    \n    .cooking-mode .main-content {\n        padding: 1.5rem;\n    }\n    \n    .cooking-mode .step-navigation {\n        flex-direction: column;\n    }\n    \n    .cooking-mode .nav-button {\n        width: 100%;\n    }\n    \n    .cooking-mode .phase-indicators {\n        flex-wrap: wrap;\n    }\n    \n    .cooking-mode .main-step {\n        font-size: 1.1rem;\n    }\n    \n    .cooking-mode .timer-controls {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n    \n    .cooking-mode .timer-button-container {\n        margin-top: 0.5rem;\n        width: 100%;\n        justify-content: space-between;\n    }\n    \n    .cooking-mode .time-remaining {\n        font-size: 1.25rem;\n        margin-top: 0.5rem;\n    }\n    \n    .cooking-mode .timer-name {\n        font-size: 1rem;\n    }\n    \n    .cooking-mode .play-pause-btn {\n        padding: 0.5rem 1rem;\n        font-size: 0.9rem;\n    }\n}\n\n.bon-appetit {\n    background-color: #28a745;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    padding: 0.75rem 1.5rem;\n    font-size: 1.1rem;\n    cursor: pointer;\n    transition: background-color 0.3s;\n    display: block;\n    margin: 2rem auto;\n}\n\n.bon-appetit:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n\n/* Make delete button more visible in the new position */\n.cooking-mode .delete-button {\n    padding: 0.25rem 0.5rem;\n    font-size: 0.9rem;\n    margin: 0;\n}",""]);const a=s},330:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,":root {\n    /* Colors */\n    --color-primary: #9d4700;  /* Brown color for main title and text */\n    --color-secondary: #4ecdc4;\n    --color-background: #faf7f2;  /* Light brown background */\n    --color-text: #333333;\n    --color-text-light: #666666;\n    --color-border: #e0d5c1;  /* Light brown border color */\n    --color-white: #fff;\n    --color-success: #2c7a51;\n    \n    /* Component Colors */\n    --color-card-shadow: rgba(0, 0, 0, 0.1);\n    --color-card-shadow-hover: rgba(0, 0, 0, 0.15);\n    --color-timer-border: #e0d5c1;\n    --color-timer-background: #f8f4ec;\n    --color-banner-background: #faf7f2;  /* Light brown for minute/difficulty banners */\n    \n    /* Spacing */\n    --spacing-xs: 0.25rem;\n    --spacing-sm: 0.5rem;\n    --spacing-md: 1rem;\n    --spacing-lg: 1.5rem;\n    --spacing-xl: 2rem;\n    --spacing-xxl: 40px;\n    \n    /* Border Radius */\n    --border-radius-sm: 4px;\n    --border-radius-md: 8px;\n    --border-radius-lg: 12px;\n    \n    /* Typography */\n    --font-family-primary: 'Prata', serif;\n    --font-size-xs: 0.75rem;\n    --font-size-sm: 0.875rem;\n    --font-size-md: 1rem;\n    --font-size-base: 1rem;\n    --font-size-lg: 1.25rem;\n    --font-size-xl: 1.5rem;\n    --font-size-xxl: 2rem;\n    --font-size-title: 2.5rem;\n    \n    /* Transitions */\n    --transition-fast: 0.2s;\n    --transition-base: 0.3s;\n\n    /* Box shadows */\n    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);\n    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);\n    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);\n} ",""]);const a=s},334:(e,t,n)=>{n.d(t,{default:()=>o});var i=n(258),r=n(548);const o=function(e){const t={containerSelector:"#timer-container, .multi-timer-container",container:null,containerInitialized:!1,init(){if(this.containerInitialized&&this.container&&document.body.contains(this.container))return console.log("Timer container already initialized"),!0;const e=this.setupContainer();return e||(console.warn("Initial timer container setup failed, trying again..."),setTimeout((()=>this.setupContainer()),500)),this.setupMutationObserver(),window.addEventListener("resize",(()=>this.handleWindowResize())),e},setupContainer(){try{return this.container=document.querySelector(this.containerSelector),this.container?console.log("Found existing timer container:",this.container):(console.log("Creating timer container element"),this.container=document.createElement("div"),this.container.id="timer-container",this.container.className="multi-timer-container",this.addContainerToDOM()),document.body.contains(this.container)||(console.error("Container exists in memory but not in DOM, reattaching"),this.addContainerToDOM()),this.container.style.display="block",this.containerInitialized=!0,!0}catch(e){console.error("Error setting up timer container:",e);try{return this.container=document.createElement("div"),this.container.id="timer-container",this.container.className="multi-timer-container",document.body.appendChild(this.container),console.log("Created fallback container after error"),this.containerInitialized=!0,!0}catch(e){return console.error("Critical failure creating container:",e),this.containerInitialized=!1,!1}}},addContainerToDOM(){try{const e=document.querySelector(".step-container"),t=document.querySelector(".step-navigation");if(e&&t)return e.insertBefore(this.container,t),console.log("Added timer container before step navigation"),!0;const n=document.querySelector(".step-content")||document.querySelector(".recipe-steps")||document.querySelector(".steps-container")||document.querySelector("main")||document.body;if(n){const e=n.querySelector(".multi-timer-container");e?(console.log("Found existing timer container, replacing it"),e.replaceWith(this.container)):(n.appendChild(this.container),console.log("Added timer container to main content"))}else document.body.appendChild(this.container),console.log("Added timer container directly to body");return!0}catch(e){console.error("Error adding container to DOM:",e);try{return document.body.appendChild(this.container),!0}catch(e){return console.error("Critical failure adding container to DOM:",e),!1}}},setupMutationObserver(){try{new MutationObserver((e=>{this.container&&!document.body.contains(this.container)&&(console.warn("Timer container was removed from DOM, reattaching"),this.addContainerToDOM())})).observe(document.body,{childList:!0,subtree:!0}),console.log("Set up mutation observer for timer container")}catch(e){console.error("Error setting up mutation observer:",e)}},getContainer(){return this.container&&document.body.contains(this.container)||this.setupContainer(),this.container},clearContainer(){this.container&&(this.container.innerHTML="")},handleWindowResize(){this.container&&this.container.querySelectorAll(".timer").forEach((e=>{const t=e.querySelector(".timer-controls");t&&(window.innerWidth<600?(t.style.flexDirection="column",t.style.gap="10px"):(t.style.flexDirection="row",t.style.gap="0"))}))}},n=function(e){if(!e)throw new Error("Event bus is required for timer controls");const t=new Map,n=new Map;return e.subscribe("timer:created",(e=>{if(e&&e.timer){const t=e.timer.id,i=n.get(t);i&&(i.innerHTML=(0,r.LU)(e.timer.duration))}})),e.subscribe("timer:started",(e=>{if(e&&e.timer){const t=e.timer.id,i=n.get(t);i&&(i.innerHTML=(0,r.LU)(e.timer.remaining))}})),e.subscribe("timer:reset",(e=>{if(e&&e.id)if(e.timer){const t=n.get(e.id);t&&(t.innerHTML=(0,r.LU)(e.timer.duration))}else if(window.timerModule&&"function"==typeof window.timerModule.getTimer){const t=window.timerModule.getTimer(e.id);if(t){const i=n.get(e.id);i&&(i.innerHTML=(0,r.LU)(t.duration))}}})),{createControls(t,i,o){if(!t||!i)return console.error("Cannot create timer controls: missing container or timer ID"),null;console.log(`Creating timer controls for timer ${i}`);try{const s=document.createElement("div");s.className="timer-controls",s.dataset.timerId=i;const a=document.createElement("div");a.className="timer-button-row";let c=0;if(console.log(`Creating controls for timer ${i}, attempting to get duration`),o&&o.duration)c=o.duration,console.log(`Using direct timer object duration: ${c}`);else if(window.timerModule&&"function"==typeof window.timerModule.getTimer){console.log(`Timer module available, trying to get timer data for ${i}`);const e=window.timerModule.getTimer(i);console.log("Timer data:",e),e&&(c=e.duration||e.remaining||0,console.log(`Got timer duration: ${c}`))}else console.log("Timer module not available or getTimer method missing");!c&&t.dataset.duration&&(c=parseInt(t.dataset.duration,10),console.log(`Using container dataset duration: ${c}`)),!c&&document.querySelector(`[data-timer-id="${i}"]`)?.dataset?.duration&&(c=parseInt(document.querySelector(`[data-timer-id="${i}"]`).dataset.duration,10),console.log(`Using DOM element dataset duration: ${c}`)),console.log(`Final timer duration for display: ${c}`);const l=document.createElement("div");l.className="inline-time-display",l.innerHTML=(0,r.LU)(c),l.dataset.timerId=i,n.set(i,l);const d=document.createElement("button");d.className="timer-button start-button",d.innerHTML='<i class="fa fa-play"></i>',d.dataset.action="start",d.dataset.timerId=i,d.setAttribute("aria-label","Start Timer"),d.title="Start Timer";const m=document.createElement("button");m.className="timer-button pause-button",m.innerHTML='<i class="fa fa-pause"></i>',m.dataset.action="pause",m.dataset.timerId=i,m.setAttribute("aria-label","Pause Timer"),m.title="Pause Timer";const p=document.createElement("button");p.className="timer-button reset-button",p.innerHTML='<i class="fa fa-sync-alt"></i>',p.dataset.action="reset",p.dataset.timerId=i,p.setAttribute("aria-label","Reset Timer"),p.title="Reset Timer",a.appendChild(d),a.appendChild(m),a.appendChild(p),a.appendChild(l),s.appendChild(a);const u=document.createElement("button");return u.className="timer-button delete-button",u.innerHTML='<i class="fa fa-trash"></i>',u.dataset.action="delete",u.dataset.timerId=i,u.setAttribute("aria-label","Delete Timer"),u.title="Delete Timer",u.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),console.log(`Delete button clicked directly for timer ${i}`),e.publish("timer:request:remove",{id:i})})),t.appendChild(s),this.setupControlEvents(s),t.addEventListener("DOMNodeRemoved",(()=>{n.delete(i)})),{container:s,startButton:d,pauseButton:m,resetButton:p,deleteButton:u,timeDisplay:l}}catch(e){return console.error("Error creating timer controls:",e),null}},generateTimerName(e){if(e.label)return e.label;if(e.metadata){if(e.metadata.sourceText&&void 0!==e.metadata.matchIndex)return(0,i._w)(e.metadata.sourceText,e.metadata.matchIndex,e.metadata.stepTitle);if(e.metadata.stepTitle)return e.metadata.stepTitle;if(e.metadata.stepPhase&&void 0!==e.metadata.stepIndex)return`${e.metadata.stepPhase.charAt(0).toUpperCase()+e.metadata.stepPhase.slice(1)} step ${e.metadata.stepIndex+1}`}return e.name||"Timer"},startEditingName(e){if(!e||t.has(e))return;const n=document.querySelector(`.timer-name[data-timer-id="${e}"]`);if(!n)return;const i=n.textContent,r=document.createElement("input");r.type="text",r.className="timer-name-input",r.value=i,r.maxLength=50,r.dataset.timerId=e;const o=()=>this.saveNameEdit(e,r.value.trim()),s=()=>this.cancelNameEdit(e,i);r.addEventListener("keydown",(e=>{"Enter"===e.key?(e.preventDefault(),o()):"Escape"===e.key&&(e.preventDefault(),s())})),r.addEventListener("blur",o),n.replaceWith(r),r.focus(),r.select(),t.set(e,{originalName:i,input:r})},saveNameEdit(n,i){if(!n||!t.has(n))return;const{originalName:r}=t.get(n),o=i||"Timer";o!==r&&e.publish("timer:rename",{id:n,name:o});const s=document.createElement("span");s.className="timer-name",s.dataset.timerId=n,s.textContent=o,s.title="Click to edit timer name",s.addEventListener("click",(()=>this.startEditingName(n)));const a=document.querySelector(`.timer-name-input[data-timer-id="${n}"]`);a&&a.replaceWith(s),t.delete(n)},cancelNameEdit(e,n){if(!e||!t.has(e))return;const i=document.createElement("span");i.className="timer-name",i.dataset.timerId=e,i.textContent=n,i.title="Click to edit timer name",i.addEventListener("click",(()=>this.startEditingName(e)));const r=document.querySelector(`.timer-name-input[data-timer-id="${e}"]`);r&&r.replaceWith(i),t.delete(e)},updatePlayPauseButton(e){if(!e?.id)return;const t=document.querySelector(`.start-btn[data-timer-id="${e.id}"]`),i=document.querySelector(`.pause-btn[data-timer-id="${e.id}"]`),o=document.querySelector(`.reset-btn[data-timer-id="${e.id}"]`);if(!t||!i||!o)return;const s=e.isRunning||"running"===e.status,a=e.isPaused||"paused"===e.status,c=e.isComplete||"completed"===e.status,l=n.get(e.id);l&&(l.innerHTML=(0,r.LU)(e.remaining||e.duration||0)),s?(t.style.display="none",i.style.display="inline-block",o.style.display="inline-block"):a||c?(t.style.display="inline-block",i.style.display="none",o.style.display="inline-block"):(t.style.display="inline-block",i.style.display="none",o.style.display="none")},cleanupTimer(e){t.has(e)&&t.delete(e)},setupControlEvents(t){if(t)try{const n=t.dataset.timerId;if(!n)return void console.error("Cannot set up control events: missing timer ID");t.querySelectorAll(".timer-button").forEach((t=>{const i=t.dataset.action;i&&t.addEventListener("click",(t=>{switch(t.preventDefault(),t.stopPropagation(),console.log(`Button clicked: ${i} for timer ${n}`),i){case"start":e.publish("timer:request:start",{id:n});break;case"pause":e.publish("timer:request:pause",{id:n});break;case"reset":e.publish("timer:request:reset",{id:n});break;case"delete":console.log(`Deleting timer ${n}`),e.publish("timer:request:remove",{id:n})}}))})),console.log(`Set up control events for timer ${n}`)}catch(e){console.error("Error setting up control events:",e)}}}}(e),o={createDisplay(e){if(!e||!e.id)throw new Error("Invalid timer object provided to createDisplay");const t=document.createElement("div");t.className="timer-display",t.dataset.timerId=e.id;const n=document.createElement("div");n.className="progress-container";const i=document.createElement("div");return i.className="progress-bar",i.dataset.timerId=e.id,i.style.width=`${this.calculateProgressPercentage(e)}%`,n.appendChild(i),t.appendChild(n),t},createStepIndicator(e){const t=void 0!==e.metadata?.stepIndex?e.metadata.stepIndex:void 0!==e.metadata?.stepId?e.metadata.stepId:null;if(null===t)return null;const n=document.createElement("div");n.className="timer-step-indicator",n.dataset.timerId=e.id,n.dataset.stepId=t.toString();const i=document.body.dataset.currentStepId,r=i&&t.toString()===i,o=e.metadata?.phaseStepNumber,s=o||(null!==t?t+1:null);r?(n.classList.add("current"),n.innerHTML=null!==s?`Step ${s} <span class="current-dot">•</span>`:'Current <span class="current-dot">•</span>'):n.textContent=null!==s?`Step ${s}`:e.metadata?.stepTitle||"Timer";const a=document.querySelector(`.timer[data-timer-id="${e.id}"]`);return a&&i&&null!==t&&(parseInt(t)<parseInt(i)?(a.classList.add("timer-previous-step"),a.classList.remove("timer-future-step","timer-current-step")):parseInt(t)>parseInt(i)?(a.classList.add("timer-future-step"),a.classList.remove("timer-previous-step","timer-current-step")):(a.classList.add("timer-current-step"),a.classList.remove("timer-previous-step","timer-future-step"))),n},updateDisplay(e,t){if(e&&t?.el)try{if(t.inlineDisplay){const n=e.getFormattedTime?e.getFormattedTime():(0,r.fU)(e.remainingTime);t.inlineDisplay.textContent=n}if(t.progress){const n=this.calculateProgressPercentage(e);t.progress.style.width=`${n}%`}t.el.classList.remove("running","paused","complete"),e.isComplete||"completed"===e.status?t.el.classList.add("complete"):e.isRunning||"running"===e.status?t.el.classList.add("running"):(e.isPaused||"paused"===e.status)&&t.el.classList.add("paused"),this.updateStepIndicator(e,t.el)}catch(e){console.error("Error updating timer display:",e)}else console.warn("Invalid timer or elements provided to updateDisplay")},updateStepIndicator(e,t){if(!t)return;const n=void 0!==e.metadata?.stepIndex?e.metadata.stepIndex:void 0!==e.metadata?.stepId?e.metadata.stepId:null;if(null===n)return;let i=t.querySelector(".timer-step-indicator");if(!i){if(i=this.createStepIndicator(e),i){const e=t.querySelector(".timer-display");e&&e.appendChild(i)}return}const r=document.body.dataset.currentStepId,o=r&&n.toString()===r;i.classList.toggle("current",o);const s=e.metadata?.phaseStepNumber,a=s||n+1;o?(i.innerHTML=`Step ${a} <span class="current-dot">•</span>`,t.classList.remove("timer-previous-step","timer-future-step"),t.classList.add("timer-current-step")):(i.textContent=`Step ${a}`,t.classList.remove("timer-current-step"),r&&parseInt(n)<parseInt(r)?(t.classList.add("timer-previous-step"),t.classList.remove("timer-future-step")):r&&parseInt(n)>parseInt(r)?(t.classList.add("timer-future-step"),t.classList.remove("timer-previous-step")):t.classList.remove("timer-previous-step","timer-future-step"))},calculateProgressPercentage(e){if(!e?.duration)return 0;const t=100-e.remainingTime/e.duration*100;return Math.max(0,Math.min(100,t))}},s={playTimerCompleteSound(){try{console.log("Attempting to play timer complete sound");let e=!1;try{const t=new Audio;t.src="/assets/sounds/timer_completed.mp3",t.volume=.5,console.log("Loading audio file from:",t.src);const n=setTimeout((()=>{console.warn("Audio file load timeout, using fallback sound"),this._playFallbackSound(),e=!0}),2e3);t.addEventListener("canplaythrough",(()=>{clearTimeout(n),e||(console.log("Timer sound loaded, playing..."),t.play().catch((e=>{console.warn("Error playing timer complete sound:",e),this._playFallbackSound()})))})),t.addEventListener("error",(e=>{clearTimeout(n),console.warn("Error loading timer sound file, using fallback",e),this._playFallbackSound()})),t.load()}catch(e){console.warn("Error creating Audio object:",e),this._playFallbackSound()}}catch(e){console.error("Critical error in timer sound system:",e)}},_playFallbackSound(){try{console.log("Playing fallback beep sound");const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),n=e.createGain();t.type="sine",t.frequency.setValueAtTime(800,e.currentTime),n.gain.setValueAtTime(.1,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+1),t.connect(n),n.connect(e.destination),t.start(),t.stop(e.currentTime+1),console.log("Fallback beep started")}catch(e){console.warn("Unable to create fallback sound:",e)}},showTimerNotification(e){try{"Notification"in window&&("granted"===Notification.permission?new Notification("Timer Complete",{body:`${e.name} timer is done!`,tag:"timer-notification",renotify:!0}):"denied"!==Notification.permission&&Notification.requestPermission().then((t=>{"granted"===t&&this.showTimerNotification(e)})))}catch(e){console.error("Error showing timer notification:",e)}},handleTimerComplete(e){this.playTimerCompleteSound(),this.showTimerNotification(e)}};return{eventBus:e,timerElements:new Map,timersMap:{},_updateQueue:new Map,_renderQueue:new Map,_processingUpdate:!1,_processingRender:!1,_processingTimers:new Set,init(){try{console.log("Timer UI initializing"),this.timersMap={},this.timerElements=new Map,t.init()||(console.error("Failed to initialize timer container"),setTimeout((()=>{console.log("Retrying timer container initialization"),t.setupContainer()}),500));const e=t.getContainer();return e&&document.body.contains(e)?console.log("Timer container found and verified in DOM"):(console.error("Timer container not found in DOM after initialization"),setTimeout((()=>{console.log("Attempting container recovery"),t.setupContainer()}),1e3)),this.setupEventHandlers(),this.loadExistingTimers(),console.log("Timer UI initialized successfully"),!0}catch(e){return console.error("Error initializing timer UI:",e),!1}},loadExistingTimers(){try{if(console.log("Loading existing timers"),this.eventBus.publish("timer:request:getAll",{}),window.moduleLoader&&window.moduleLoader.has("timer"))try{const e=window.moduleLoader.get("timer")._timerModuleInstance;if(e&&e._timerCoreInstance){const t=e._timerCoreInstance.getAllTimers();t&&t.length>0&&(console.log(`Directly rendering ${t.length} timers from core instance`),this.renderTimers(t))}}catch(e){console.error("Error accessing timer module directly:",e)}}catch(e){console.error("Error loading existing timers:",e)}},setupEventHandlers(){try{console.log("Setting up timer UI event handlers"),this.eventBus.subscribe("timer:created",(e=>{console.log("Received timer:created event:",e),this.renderTimer(e.timer)})),this.eventBus.subscribe("timer:started",(e=>{console.log("Received timer:started event:",e),this.updateTimer(e.timer)})),this.eventBus.subscribe("timer:paused",(e=>{console.log("Received timer:paused event:",e),this.updateTimer(e.timer)})),this.eventBus.subscribe("timer:reset",(e=>{console.log("Received timer:reset event:",e),this.updateTimer(e.timer)})),this.eventBus.subscribe("timer:updated",(e=>{console.log("Received timer:updated event:",e),this.updateTimer(e.timer)})),this.eventBus.subscribe("timer:tick",(e=>{this.updateTimer(e.timer)})),this.eventBus.subscribe("timer:completed",(e=>{console.log("Received timer:completed event:",e),this.updateTimer(e.timer),s.handleTimerComplete(e.timer)})),this.eventBus.subscribe("timer:removed",(e=>{console.log("Received timer:removed event:",e);const t=e.id||e.timer&&e.timer.id;t?(console.log(`Removing timer element for timer ${t}`),this.removeTimerElement(t)):console.error("Invalid timer:removed event data format:",e)})),this.eventBus.subscribe("timers:cleared",(()=>{console.log("Received timers:cleared event"),t.clearContainer(),this.timersMap={},this.timerElements.clear()})),this.eventBus.subscribe("timers:loaded",(e=>{console.log("Received timers:loaded event:",e),this.renderTimers(e.timers)})),this.eventBus.subscribe("timer:initialized",(()=>{console.log("Received timer:initialized event"),this.renderExistingTimers()})),window.addEventListener("resize",(()=>t.handleWindowResize())),document.addEventListener("timer:module:ready",(()=>{this.renderExistingTimers()})),this.eventBus.subscribe("timer:notify:complete",this.handleTimerNotification.bind(this)),console.log("Timer UI event handlers set up successfully")}catch(e){console.error("Error setting up timer UI event handlers:",e)}},_processUpdateQueue(){if(this._processingUpdate||0===this._updateQueue.size)return;let e;this._processingUpdate=!0;try{const[t,i]=this._updateQueue.entries().next().value;if(e=t,this._updateQueue.delete(t),this._processingTimers.has(e))return void console.log(`Timer ${e} already being processed, skipping update`);this._processingTimers.add(e);const r=this.timersMap[e];if(!r)return console.log(`Timer ${e} not found in UI, queueing render`),this._processingTimers.delete(e),void this._queueRender(i);if(!document.body.contains(r.el))return console.log(`Timer ${e} element not in DOM, queueing re-render`),delete this.timersMap[e],this.timerElements.delete(e),this._processingTimers.delete(e),void this._queueRender(i);o.updateDisplay(i,r),n.updatePlayPauseButton(i)}catch(e){console.error("Error processing update queue:",e)}finally{this._processingUpdate=!1,e&&this._processingTimers.delete(e),this._updateQueue.size>0&&setTimeout((()=>this._processUpdateQueue()),0)}},_queueUpdate(e){this._processingTimers.has(e.id)?console.log(`Timer ${e.id} already being processed, skipping update`):(this._updateQueue.set(e.id,e),setTimeout((()=>this._processUpdateQueue()),0))},_processRenderQueue(){if(this._processingRender||0===this._renderQueue.size)return;let e;this._processingRender=!0;try{const[t,n]=this._renderQueue.entries().next().value;if(e=t,this._renderQueue.delete(t),this._processingTimers.has(t))return void console.log(`Timer ${t} already being processed, skipping render`);this._processingTimers.add(t),this._renderTimerInternal(n)}catch(e){console.error("Error processing render queue:",e)}finally{this._processingRender=!1,e&&this._processingTimers.delete(e),this._renderQueue.size>0&&setTimeout((()=>this._processRenderQueue()),0)}},_queueRender(e){this._processingTimers.has(e.id)?console.log(`Timer ${e.id} already being processed, skipping render`):(this._renderQueue.set(e.id,e),setTimeout((()=>this._processRenderQueue()),0))},_renderTimerInternal(e){try{const i=document.getElementById(`timer-container-${e.id}`);if(i)return o.updateDisplay(e,this.timersMap[e.id]),n.updatePlayPauseButton(e),i;const r=document.createElement("div");r.id=`timer-container-${e.id}`,r.className="timer",r.dataset.timerId=e.id,r.dataset.stepId=e.metadata?.stepId||"";try{const i=document.createElement("div");i.className="timer-name-container";const s=document.createElement("span");if(s.className="timer-name",s.dataset.timerId=e.id,s.textContent=e.name||n.generateTimerName(e)||"Timer",s.title="Click to edit timer name",s.addEventListener("click",(()=>n.startEditingName(e.id))),i.appendChild(s),e.metadata&&void 0!==e.metadata.stepId){const t=document.createElement("span");t.className="timer-step-indicator",t.dataset.stepId=e.metadata.stepId;const n=e.metadata.phaseStepNumber||"?",o=document.body.dataset.currentStepId;if(o&&o===e.metadata.stepId.toString()){t.classList.add("current"),t.textContent=`Step ${n} `;const e=document.createElement("span");e.className="current-dot",e.textContent="•",t.appendChild(e)}else t.textContent=`Step ${n}`;const s=document.createElement("div");s.className="timer-right-controls",s.appendChild(t),i.appendChild(s),r.rightControls=s}r.appendChild(i),r.dataset.duration=e.duration||0;const a=n.createControls(r,e.id,e);let c;a&&a.deleteButton&&(r.rightControls?r.rightControls.appendChild(a.deleteButton):i.appendChild(a.deleteButton));try{c=o.createDisplay(e)}catch(t){return console.error(`Error creating display for timer ${e.id}:`,t),null}if(a&&c){r.appendChild(a.container);const n=t.getContainer();return n?(n.appendChild(r),this.timersMap[e.id]={el:r,nameEl:s,inlineDisplay:a.container.querySelector(".inline-time-display"),controls:a.container},r):(console.error("Cannot find timer container element in DOM"),null)}return console.error(`Failed to create UI components for timer ${e.id}`),null}catch(t){return console.error(`Error creating timer UI components for timer ${e.id}:`,t),null}}catch(e){throw console.error("Error rendering timer:",e),e}},renderTimer(e){this._queueRender(e)},updateTimer(e){this._queueUpdate(e)},removeTimerElement(e){try{console.log(`Attempting to remove timer element for ${e}`);const t=this.timersMap[e];if(!t)return void console.log(`No timer reference found for ${e}`);console.log("Found timer element reference:",t),t.el&&document.body.contains(t.el)?(console.log(`Removing timer element from DOM for ${e}`),t.el.remove()):console.log(`Timer element not found in DOM for ${e}`),delete this.timersMap[e],this.timerElements.delete(e),console.log(`Timer ${e} removed successfully`)}catch(e){console.error("Error removing timer element:",e)}},renderTimers(e){try{console.log("Rendering multiple timers:",e),Array.isArray(e)&&e.forEach((e=>{this.renderTimer(e)}))}catch(e){console.error("Error rendering multiple timers:",e)}},renderExistingTimers(){this.loadExistingTimers()},handleTimerNotification(e){e&&e.playSound&&s.playTimerCompleteSound()}}}},343:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,'/* Recipe Grid */\n.recipe-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n    gap: var(--spacing-xl);\n    margin-top: var(--spacing-xl);\n}\n\n/* Recipe Card Specific */\n.recipe-grid .recipe-card {\n    background-color: var(--color-white);\n    border-radius: var(--border-radius-lg);\n    overflow: hidden;\n    box-shadow: var(--shadow-md);\n    transition: transform var(--transition-base), box-shadow var(--transition-base);\n    cursor: pointer;\n    display: flex;\n    flex-direction: column;\n}\n\n.recipe-grid .recipe-card:hover {\n    transform: translateY(-5px);\n    box-shadow: var(--shadow-lg);\n}\n\n.recipe-grid .recipe-thumbnail {\n    width: 100%;\n    height: 200px;\n    object-fit: cover;\n}\n\n.recipe-grid .recipe-info {\n    padding: var(--spacing-md);\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n/* Card Title Specific */\n.recipe-grid .recipe-title {\n    margin-bottom: var(--spacing-sm);\n    font-size: var(--font-size-xl);\n}\n\n/* Card Meta Info */\n.recipe-grid .recipe-meta {\n    color: var(--color-text-light);\n    font-size: var(--font-size-sm);\n    margin-top: auto;\n    background-color: var(--color-background);\n    padding: var(--spacing-xs) var(--spacing-md);\n    border-radius: var(--border-radius-sm);\n    width: 100%;\n    height: auto;\n    box-sizing: border-box;\n}\n\n.recipe-grid .recipe-meta span {\n    color: var(--color-text-light);\n    font-size: var(--font-size-sm);\n    white-space: nowrap;\n}\n\n.recipe-grid .recipe-time,\n.recipe-grid .recipe-difficulty {\n    color: var(--color-text-light);\n    font-size: var(--font-size-sm);\n    display: inline;\n}\n\n.recipe-grid .recipe-time::after {\n    content: "•";\n    margin: 0 var(--spacing-xs);\n}\n\n/* Responsive styles */\n@media (max-width: 768px) {\n    .recipe-grid {\n        grid-template-columns: 1fr;\n    }\n}',""]);const a=s},433:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Voice Recognition and Speech Synthesis Styles */\n\n/* Voice Command UI */\n.voice-command-ui {\n    margin-top: 20px;\n    padding: 15px;\n    background-color: #f5f5f5;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n/* Voice controls enhanced layout */\n.voice-controls-enhanced {\n    margin-top: 20px;\n    padding: 15px;\n    background-color: #f9f9f9;\n    border-radius: 8px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.voice-toggle {\n    padding: 8px 15px;\n    width: 100%;\n    max-width: 300px;\n}\n\n.voice-status {\n    margin: 10px 0;\n    padding: 8px;\n    font-size: 0.9rem;\n    border-radius: 4px;\n    text-align: center;\n    width: 100%;\n}\n\n.voice-status.active {\n    background-color: #e8f5e9;\n    color: #2e7d32;\n}\n\n.voice-status.inactive {\n    background-color: #f5f5f5;\n    color: #757575;\n}\n\n.voice-status.error {\n    background-color: #ffebee;\n    color: #c62828;\n}\n\n/* Small commands button style */\n.commands-button {\n    font-size: 0.8rem;\n    padding: 5px 10px;\n    background-color: #f0f0f0;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    color: #555;\n    cursor: pointer;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    transition: background-color 0.2s;\n}\n\n.commands-button:hover {\n    background-color: #e3e3e3;\n}\n\n/* Voice Button */\n.voice-btn {\n    padding: 8px 15px;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: all 0.3s ease;\n    display: flex;\n    align-items: center;\n    gap: 5px;\n}\n\n.voice-btn.primary {\n    background-color: #2196F3;\n    color: white;\n}\n\n.voice-btn.secondary {\n    background-color: #9E9E9E;\n    color: white;\n}\n\n.voice-btn:hover {\n    opacity: 0.9;\n    transform: translateY(-2px);\n}\n\n.voice-btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n/* Voice Icon */\n.voice-icon {\n    width: 20px;\n    height: 20px;\n    fill: currentColor;\n}\n\n/* Voice Animation */\n.voice-animation {\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    margin-right: 5px;\n}\n\n.voice-animation.listening {\n    animation: pulse 1.5s infinite;\n}\n\n@keyframes pulse {\n    0% {\n        transform: scale(0.95);\n        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7);\n    }\n    \n    70% {\n        transform: scale(1);\n        box-shadow: 0 0 0 10px rgba(33, 150, 243, 0);\n    }\n    \n    100% {\n        transform: scale(0.95);\n        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0);\n    }\n}\n\n/* Hide command suggestions since we're removing them */\n.command-suggestions {\n    display: none;\n}\n\n/* Commands Panel */\n.commands-panel {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    background-color: #f8f5e6;\n    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n    border-top-left-radius: 15px;\n    border-top-right-radius: 15px;\n    padding: 0;\n    transform: translateY(100%);\n    transition: transform 0.3s ease;\n    z-index: 1000;\n    max-height: 80vh;\n    overflow-y: auto;\n}\n\n.commands-panel.active {\n    transform: translateY(0);\n}\n\n.commands-panel-inner {\n    padding: 20px;\n    position: relative;\n}\n\n.commands-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n    gap: 15px;\n    margin-top: 15px;\n}\n\n.commands-panel h3 {\n    margin-top: 0;\n    margin-bottom: 20px;\n    text-align: center;\n    color: var(--color-primary, #9d4700);\n    font-size: 1.2rem;\n}\n\n.close-commands-btn {\n    position: absolute;\n    top: 15px;\n    right: 15px;\n    font-size: 24px;\n    line-height: 24px;\n    width: 30px;\n    height: 30px;\n    border: none;\n    background: transparent;\n    cursor: pointer;\n    color: #666;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n}\n\n.close-commands-btn:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n    color: #333;\n}\n\n.command-category {\n    margin-bottom: 15px;\n    padding: 15px;\n    background-color: white;\n    border-radius: 8px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n    border: 1px solid #e6dfc3;\n}\n\n.command-category h4 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    color: var(--color-primary, #9d4700);\n    border-bottom: 1px solid #e6dfc3;\n    padding-bottom: 5px;\n    font-size: 0.95rem;\n}\n\n.command-category ul {\n    list-style-type: none;\n    padding-left: 0;\n    margin: 0;\n}\n\n.command-category li {\n    padding: 4px 0;\n    font-size: 0.85rem;\n    color: #555;\n    margin-bottom: 4px;\n    border-left: none;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n    .commands-grid {\n        grid-template-columns: 1fr;\n    }\n    \n    .commands-panel {\n        max-height: 90vh;\n    }\n} ",""]);const a=s},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},548:(e,t,n)=>{function i(e){if(!e&&0!==e)return"00:00";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function r(e){return function(e){if(!e&&0!==e)return"0 seconds";const t=Math.floor(e/60),n=e%60;return t>0&&n>0?`${t} min ${n} sec`:t>0?`${t} min`:`${n} sec`}(e)}function o(e,t){try{return localStorage.setItem(e,function(e,t="{}"){try{return JSON.stringify(e)}catch(e){return t}}(t)),!0}catch(e){return console.error("Failed to save to localStorage:",e),!1}}function s(e,t=null){try{const n=localStorage.getItem(e);return n?function(e,t={}){try{return JSON.parse(e)}catch(e){return t}}(n,t):t}catch(e){return console.error("Failed to get from localStorage:",e),t}}function a(e){return e?e.trim().toLowerCase().replace(/\s+/g," "):""}n.d(t,{LU:()=>i,Ml:()=>s,dL:()=>o,fU:()=>r,mO:()=>a})},567:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,'/* Recipe Viewer Styles */\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: var(--spacing-md);\n    font-family: var(--font-family-primary);\n}\n\n.back-button {\n    display: inline-block;\n    margin-bottom: var(--spacing-md);\n    color: var(--color-primary);\n    text-decoration: none;\n    font-size: var(--font-size-lg);\n    transition: color var(--transition-base);\n}\n\n.back-button:hover {\n    text-decoration: underline;\n}\n\n/* Recipe Viewer Specific Styles */\n\n/* Recipe Container - white box with title, image, and metadata */\n.recipe-container {\n    background-color: var(--color-white);\n    border-radius: var(--border-radius-lg);\n    box-shadow: var(--shadow-md);\n    padding: var(--spacing-xl);\n    margin-bottom: var(--spacing-xl);\n    position: relative;\n    max-width: 900px;\n    margin-left: auto;\n    margin-right: auto;\n}\n\n/* Recipe Title */\n.recipe-title {\n    color: var(--color-primary);\n    font-size: var(--font-size-title);\n    margin-bottom: var(--spacing-xl);\n    font-weight: normal;\n    line-height: 1.2;\n    font-family: var(--font-family-primary);\n}\n\n/* Intro Layout - image and metadata side by side */\n.intro-layout {\n    display: grid;\n    grid-template-columns: 350px 350px;\n    gap: var(--spacing-xl);\n    margin-bottom: var(--spacing-xl);\n    align-items: start;\n}\n\n/* Recipe Image */\n.intro-image-container {\n    width: 350px;\n    height: 250px;\n    overflow: hidden;\n    border-radius: var(--border-radius-md);\n    box-shadow: var(--shadow-md);\n}\n\n.recipe-image {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    object-position: center;\n    transition: transform var(--transition-base);\n}\n\n.recipe-image:hover {\n    transform: scale(1.02);\n}\n\n/* Recipe Metadata */\n.recipe-meta {\n    background-color: var(--color-background);\n    border-radius: var(--border-radius-md);\n    padding: var(--spacing-lg);\n    width: 350px;\n    height: 250px;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    overflow-y: auto;\n}\n\n.meta-item {\n    display: flex;\n    margin-bottom: var(--spacing-md);\n    align-items: baseline;\n}\n\n.meta-item:last-child {\n    margin-bottom: 0;\n}\n\n.meta-label {\n    color: var(--color-primary);\n    font-weight: 500;\n    width: 150px;\n    flex-shrink: 0;\n}\n\n.meta-value {\n    color: var(--color-text);\n    font-size: var(--font-size-base);\n}\n\n/* Recipe Actions */\n.recipe-actions {\n    display: flex;\n    gap: var(--spacing-md);\n    margin-top: var(--spacing-xl);\n}\n\n/* Ingredients Section - outside the recipe container */\n.ingredients-section {\n    padding: var(--spacing-xl) 0;\n    border-top: 1px solid var(--color-border);\n}\n\n.ingredients-section h2 {\n    color: var(--color-primary);\n    font-size: var(--font-size-xxl);\n    margin-bottom: var(--spacing-lg);\n    font-weight: normal;\n    font-family: var(--font-family-primary);\n}\n\n/* Ingredients List */\n.ingredients-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    columns: 2;\n    column-gap: var(--spacing-xxl);\n}\n\n.ingredients-list li {\n    margin-bottom: var(--spacing-sm);\n    break-inside: avoid;\n    padding-left: var(--spacing-md);\n    position: relative;\n    line-height: 1.4;\n    color: var(--color-text);\n}\n\n.ingredients-list li::before {\n    content: "•";\n    position: absolute;\n    left: 0;\n    color: var(--color-primary);\n}\n\n/* Responsive styles */\n@media (max-width: 768px) {\n    .recipe-container {\n        padding: var(--spacing-md);\n    }\n    \n    .intro-layout {\n        grid-template-columns: 1fr;\n        gap: var(--spacing-lg);\n    }\n    \n    .intro-image-container {\n        aspect-ratio: 16/9;\n        min-height: auto;\n    }\n    \n    .recipe-meta {\n        margin-top: var(--spacing-md);\n        min-height: auto;\n    }\n    \n    .recipe-actions {\n        flex-direction: column;\n        margin-top: var(--spacing-lg);\n    }\n    \n    .recipe-title {\n        font-size: var(--font-size-xxl);\n    }\n    \n    .meta-item {\n        flex-direction: column;\n        gap: var(--spacing-xs);\n    }\n    \n    .meta-label {\n        width: 100%;\n        border-bottom: 1px solid var(--color-border);\n        padding-bottom: var(--spacing-xs);\n    }\n    \n    .primary-button,\n    .secondary-button {\n        width: 100%;\n        text-align: center;\n    }\n    \n    .ingredients-list {\n        columns: 1;\n    }\n}\n\n/* Loading Overlay */\n.loading-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(255, 255, 255, 0.9);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.loading-container {\n    text-align: center;\n    padding: var(--spacing-xl);\n}\n\n.loading-spinner {\n    width: 50px;\n    height: 50px;\n    border: 4px solid var(--color-background);\n    border-top: 4px solid var(--color-primary);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin: 0 auto var(--spacing-md);\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n/* Shopping list styles moved to _shopping-list.css */ ',""]);const a=s},598:(e,t,n)=>{n.d(t,{default:()=>s});var i=n(548),r=n(936);n(258);const o="recipe-viewer-timers";console.log("timer-core.js loaded");const s=function(e){return{eventBus:e,timers:{},timerIntervals:{},init(){try{return console.log("Initializing timer core..."),this.timers={},this.timerIntervals={},this.loadTimers(),this.setupEventHandlers(),console.log("Timer core initialized successfully"),this.eventBus.publish("timer:initialized",null),!0}catch(e){return console.error("Error initializing timer core:",e),!1}},setupEventHandlers(){this.eventBus.subscribe("timer:request:create",this.handleCreateRequest.bind(this)),this.eventBus.subscribe("timer:request:start",this.handleStartRequest.bind(this)),this.eventBus.subscribe("timer:request:pause",this.handlePauseRequest.bind(this)),this.eventBus.subscribe("timer:request:reset",this.handleResetRequest.bind(this)),this.eventBus.subscribe("timer:request:remove",this.handleRemoveRequest.bind(this)),this.eventBus.subscribe("timer:request:get",this.handleGetRequest.bind(this)),this.eventBus.subscribe("timer:request:getAll",this.handleGetAllRequest.bind(this)),this.eventBus.subscribe("timer:request:list:all",this.handleListAllRequest.bind(this)),this.eventBus.subscribe("timer:request:clear",this.handleClearAllRequest.bind(this)),this.eventBus.subscribe("timer:request:rename",this.handleRenameRequest.bind(this)),this.eventBus.subscribe("timer:request:addMetadata",this.handleAddMetadataRequest.bind(this)),this.eventBus.subscribe("timer:request:highlightStep",this.handleHighlightStepRequest.bind(this)),this.eventBus.subscribe("timer:request:start:all",this.handleStartAllRequest.bind(this)),this.eventBus.subscribe("timer:request:pause:all",this.handlePauseAllRequest.bind(this)),this.eventBus.subscribe("timer:request:reset:all",this.handleResetAllRequest.bind(this)),this.eventBus.subscribe("timer:request:start:byName",this.handleStartByNameRequest.bind(this)),this.eventBus.subscribe("timer:request:pause:byName",this.handlePauseByNameRequest.bind(this)),this.eventBus.subscribe("timer:request:reset:byName",this.handleResetByNameRequest.bind(this)),this.eventBus.subscribe("timer:request:remove:byName",this.handleRemoveByNameRequest.bind(this)),console.log("Timer core event handlers set up")},handleCreateRequest(e){const t=this.createTimer(e);this.eventBus.publish("timer:created:response",{id:t}),this.persistTimers()},handleStartRequest(e){if(e&&e.id){const t=this.startTimer(e.id);this.eventBus.publish("timer:start:response",{id:e.id,success:t})}},handlePauseRequest(e){if(e&&e.id){const t=this.pauseTimer(e.id);this.eventBus.publish("timer:pause:response",{id:e.id,success:t})}},handleResetRequest(e){if(e&&e.id){const t=this.resetTimer(e.id);this.eventBus.publish("timer:reset:response",{id:e.id,success:t})}},handleRemoveRequest(e){if(console.log("Received timer:request:remove event with data:",e),e&&e.id){console.log(`Attempting to remove timer with ID: ${e.id}`);const t=this.removeTimer(e.id);console.log(`Timer removal ${t?"successful":"failed"} for ID: ${e.id}`),this.eventBus.publish("timer:remove:response",{id:e.id,success:t})}else console.error("Invalid timer remove request - missing timer ID:",e)},handleGetRequest(e){if(e&&e.id){const t=this.timers[e.id];this.eventBus.publish("timer:get:response",{timer:t}),e.callback&&"function"==typeof e.callback&&e.callback(t)}},handleGetAllRequest(){const e=Object.values(this.timers);this.eventBus.publish("timers:loaded",{timers:e})},handleListAllRequest(e){console.log("Handling request to list all timers with callback");const t=Object.values(this.timers).map((e=>({id:e.id,name:e.name,status:e.status,remaining:e.remaining,isRunning:e.isRunning})));return e&&"function"==typeof e.callback&&(console.log(`Calling callback with ${t.length} timers`),e.callback(t)),t},handleClearAllRequest(){try{Object.keys(this.timers).forEach((e=>{try{this.removeTimer(e)}catch(t){console.error(`Error removing timer ${e} during clear all:`,t)}})),this.timers={},Object.keys(this.timerIntervals).forEach((e=>{this.timerIntervals[e]&&(clearInterval(this.timerIntervals[e]),delete this.timerIntervals[e])})),this.persistTimers(),this.eventBus.publish("timers:cleared",null)}catch(e){console.error("Error clearing timers:",e),this.timers={},this.timerIntervals={},this.persistTimers()}},handleRenameRequest(e){try{const{id:t,name:n}=e,i=this.timers[t];if(!i)return void console.error(`Timer not found: ${t}`);i.rename(n),this.persistTimers(),this.eventBus.publish("timer:renamed",{id:t,name:n})}catch(t){console.error(`Error renaming timer ${e.id}:`,t)}},handleAddMetadataRequest(e){try{const{id:t,metadata:n}=e,i=this.timers[t];if(!i)return void console.error(`Timer not found: ${t}`);i.addMetadata(n),this.persistTimers(),this.eventBus.publish("timer:metadata:added",{id:t,metadata:n})}catch(t){console.error(`Error adding metadata to timer ${e.id}:`,t)}},handleHighlightStepRequest(e){try{const{stepId:t}=e,n=Object.values(this.timers).filter((e=>{const n=e.getMetadata();return n&&n.stepId===t}));this.eventBus.publish("timer:highlight:step",{stepId:t,timers:n})}catch(t){console.error(`Error highlighting step ${e.stepId}:`,t)}},updateTimer(e){try{const t=this.timers[e];if(!t)return void console.error(`Timer not found: ${e}`);const n=t.getStatus(),i=t.getRemainingTime();"running"===n&&this.eventBus.publish("timer:tick",{timer:t}),i<=0&&"running"===n&&this.completeTimer(e)}catch(t){console.error(`Error updating timer ${e}:`,t)}},completeTimer(e){try{const t=this.timers[e];if(!t)return void console.error(`Timer not found: ${e}`);t.complete(),this.showTimerNotification(t),this.eventBus.publish("timer:completed",{timer:t}),this.persistTimers()}catch(t){console.error(`Error completing timer ${e}:`,t)}},createTimer(e){try{const t="timer_"+Date.now()+"_"+Math.floor(1e3*Math.random());console.log("Creating timer with data:",e);const n=new r.M({id:t,name:e.name||"Timer",duration:e.duration||60,onComplete:()=>{this.completeTimer(t)},metadata:e.metadata||{}});return this.timers[t]=n,console.log(`Created timer: ${t}, name: ${n.name}, duration: ${n.duration}s`),this.persistTimers(),this.eventBus.publish("timer:created",{timer:n}),e.autoStart&&(console.log(`Auto-starting timer: ${t}`),setTimeout((()=>{this.startTimer(t)}),100)),t}catch(e){return console.error("Error creating timer:",e),null}},startTimer(e){try{console.log(`startTimer called for ${e}`);const t=this.timers[e];return t?(console.log(`Starting timer: ${t.name} (${e})`),t.start(),this.timerIntervals[e]||(console.log(`Setting up interval for timer ${e}`),this.timerIntervals[e]=setInterval((()=>{this.updateTimer(e)}),1e3)),this.eventBus.publish("timer:started",{timer:t}),console.log(`Published timer:started event for ${e}`),!0):(console.error(`Timer not found: ${e}`),!1)}catch(t){return console.error(`Error starting timer ${e}:`,t),!1}},pauseTimer(e){try{const t=this.timers[e];return t?(t.pause(),this.eventBus.publish("timer:paused",{id:e}),!0):(console.error(`Timer not found: ${e}`),!1)}catch(t){return console.error(`Error pausing timer ${e}:`,t),!1}},resetTimer(e){try{const t=this.timers[e];return t?(t.reset(),this.eventBus.publish("timer:reset",{id:e,timer:t}),!0):(console.error(`Timer not found: ${e}`),!1)}catch(t){return console.error(`Error resetting timer ${e}:`,t),!1}},stopTimer(e){try{const t=this.timers[e];return t?(t.pause(),this.eventBus.publish("timer:stopped",{id:e}),!0):(console.error(`Timer not found: ${e}`),!1)}catch(t){return console.error(`Error stopping timer ${e}:`,t),!1}},removeTimer(e){try{console.log(`removeTimer called for ${e}`);const t=this.timers[e];return t?(console.log(`Found timer to remove: ${t.name} (${e})`),t.cleanup(),delete this.timers[e],console.log(`Deleted timer ${e} from timers collection`),this.timerIntervals[e]&&(console.log(`Clearing interval for timer ${e}`),clearInterval(this.timerIntervals[e]),delete this.timerIntervals[e]),this.persistTimers(),console.log(`Publishing timer:removed event for ${e}`),this.eventBus.publish("timer:removed",{id:e}),!0):(console.error(`Timer not found: ${e}`),!1)}catch(t){return console.error(`Error removing timer ${e}:`,t),!1}},getAllTimers(){return Object.values(this.timers)},getTimer(e){return this.timers[e]||null},showTimerNotification(e){try{const t=e.name,n=e.id;if("Notification"in window)if("granted"===Notification.permission){const e=new Notification("Timer Complete",{body:`Timer "${t}" has completed!`,icon:"/assets/images/favicon.ico"});e.onclick=()=>{window.focus(),e.close()}}else"denied"!==Notification.permission&&Notification.requestPermission().then((t=>{"granted"===t&&this.showTimerNotification(e)}));this.eventBus.publish("timer:notify:complete",{id:n,name:t,playSound:!0})}catch(e){console.error("Error showing timer notification:",e)}},loadTimers(){try{(0,i.Ml)(o,[]).forEach((e=>{const t=new r.M({id:e.id,name:e.name,duration:e.duration,onComplete:()=>{this.completeTimer(e.id)},metadata:e.metadata||{}});t.remaining=e.remainingTime||e.duration,t.status=e.status||"idle",t.completion=e.completion||0,this.timers[e.id]=t})),console.log(`Loaded ${Object.keys(this.timers).length} timers from storage`)}catch(e){console.error("Error loading timers from storage:",e)}},saveTimersToStorage(){try{const e=Object.values(this.timers).map((e=>({id:e.id,name:e.name,duration:e.duration,remainingTime:e.getRemainingTime(),status:e.getStatus(),completion:e.getCompletion(),metadata:e.getMetadata()})));(0,i.dL)(o,e),console.log(`Saved ${e.length} timers to storage`)}catch(e){console.error("Error saving timers to storage:",e)}},persistTimers(){0===Object.keys(this.timers).length?((0,i.dL)(o,[]),console.log("Cleared all timers from storage")):this.saveTimersToStorage()},handleStartAllRequest(){try{console.log("handleStartAllRequest called - starting all timers");const e=Object.keys(this.timers);console.log(`Found ${e.length} timers to potentially start:`,e);let t=0;e.forEach((e=>{const n=this.timers[e];n&&(console.log(`Checking timer ${e}:`,{isRunning:n._isRunning,status:n.status,name:n.name}),n._isRunning||"completed"===n.status?console.log(`Skipping timer ${e} because it's already running or completed`):(console.log(`Starting timer ${e}: ${n.name}`),this.startTimer(e),t++))})),console.log(`Started ${t} timers`),this.eventBus.publish("timer:start:all:response",{count:t})}catch(e){console.error("Error starting all timers:",e)}},handlePauseAllRequest(){try{const e=Object.keys(this.timers);let t=0;e.forEach((e=>{const n=this.timers[e];n&&n._isRunning&&(this.pauseTimer(e),t++)})),console.log(`Paused ${t} timers`),this.eventBus.publish("timer:pause:all:response",{count:t})}catch(e){console.error("Error pausing all timers:",e)}},handleResetAllRequest(){try{const e=Object.keys(this.timers);let t=0;e.forEach((e=>{this.resetTimer(e),t++})),console.log(`Reset ${t} timers`),this.eventBus.publish("timer:reset:all:response",{count:t})}catch(e){console.error("Error resetting all timers:",e)}},clearAllTimers(){try{return Object.keys(this.timers).forEach((e=>{this.removeTimer(e)})),this.persistTimers(),!0}catch(e){return console.error("Error clearing all timers:",e),!1}},handleStartByNameRequest(e){if(console.log("Handling start timer by name request:",e),!e||!e.name)return void console.error("Invalid timer start by name request - missing timer name");const t=this.findTimerIdByName(e.name);if(t){console.log(`Found timer with name "${e.name}", ID: ${t}, starting it`);const n=this.startTimer(t);this.eventBus.publish("timer:start:response",{id:t,success:n})}else console.log(`No timer found with name "${e.name}"`)},handlePauseByNameRequest(e){if(console.log("Handling pause timer by name request:",e),!e||!e.name)return void console.error("Invalid timer pause by name request - missing timer name");const t=this.findTimerIdByName(e.name);if(t){console.log(`Found timer with name "${e.name}", ID: ${t}, pausing it`);const n=this.pauseTimer(t);this.eventBus.publish("timer:pause:response",{id:t,success:n})}else console.log(`No timer found with name "${e.name}"`)},handleResetByNameRequest(e){if(console.log("Handling reset timer by name request:",e),!e||!e.name)return void console.error("Invalid timer reset by name request - missing timer name");const t=this.findTimerIdByName(e.name);if(t){console.log(`Found timer with name "${e.name}", ID: ${t}, resetting it`);const n=this.resetTimer(t);this.eventBus.publish("timer:reset:response",{id:t,success:n})}else console.log(`No timer found with name "${e.name}"`)},handleRemoveByNameRequest(e){if(console.log("Handling remove timer by name request:",e),!e||!e.name)return void console.error("Invalid timer remove by name request - missing timer name");const t=this.findTimerIdByName(e.name);if(t){console.log(`Found timer with name "${e.name}", ID: ${t}, removing it`);const n=this.removeTimer(t);this.eventBus.publish("timer:remove:response",{id:t,success:n})}else console.log(`No timer found with name "${e.name}"`)},findTimerIdByName(e){console.log(`Searching for timer with name: "${e}"`);const t=e.toLowerCase().trim();console.log("Available timers:",Object.entries(this.timers).map((([e,t])=>({id:e,name:t.name,status:t.status}))));for(const[e,n]of Object.entries(this.timers))if(n.name.toLowerCase()===t)return console.log(`Found exact match for timer: ${n.name}`),e;const n=t.endsWith(" timer")?t:t+" timer";for(const[e,t]of Object.entries(this.timers))if(t.name.toLowerCase()===n)return console.log(`Found match with "timer" suffix: ${t.name}`),e;const i=t.split(/\s+/);for(const e of i)if(!(e.length<3)){console.log(`Trying to match with keyword: "${e}"`);for(const[t,n]of Object.entries(this.timers))if(n.name.toLowerCase().includes(e))return console.log(`Found match with keyword "${e}" for timer: ${n.name}`),t}for(const[e,n]of Object.entries(this.timers)){const i=n.name.toLowerCase();if(i.includes(t)||t.includes(i))return console.log(`Found partial match for timer: ${n.name}`),e}return console.log(`No timer found with name similar to "${e}"`),null}}}},601:e=>{e.exports=function(e){return e[1]}},605:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Voice Controls */\n.voice-controls {\n    text-align: center;\n    margin-top: var(--spacing-xl);\n    padding: var(--spacing-md);\n    background-color: var(--color-timer-background);\n    border-radius: var(--border-radius-md);\n}\n\n.voice-controls-button {\n    background-color: var(--color-primary);\n    color: var(--color-white);\n    padding: var(--spacing-sm) var(--spacing-md);\n    border: none;\n    border-radius: var(--border-radius-sm);\n    font-size: var(--font-size-md);\n    cursor: pointer;\n    transition: all var(--transition-base);\n}\n\n.voice-controls-button:hover {\n    background-color: var(--color-primary-dark);\n}\n\n.voice-status {\n    margin-top: var(--spacing-sm);\n    font-style: italic;\n    color: var(--color-text-light);\n}\n\n/* Enhanced Voice Controls */\n.voice-controls-enhanced {\n    position: relative;\n    margin-top: var(--spacing-xl);\n    background-color: var(--color-timer-background);\n    border-radius: var(--border-radius-md);\n    padding: var(--spacing-md);\n}\n\n.voice-command-button-container {\n    display: flex;\n    justify-content: center;\n    margin-bottom: var(--spacing-sm);\n}\n\n.voice-status-container {\n    text-align: center;\n    margin-bottom: var(--spacing-sm);\n}\n\n.command-suggestions {\n    background-color: var(--color-white);\n    border-radius: var(--border-radius-sm);\n    padding: var(--spacing-sm);\n    margin-top: var(--spacing-sm);\n    box-shadow: var(--shadow-sm);\n}\n\n.suggestion-tag {\n    font-weight: bold;\n    color: var(--color-primary);\n    margin-bottom: var(--spacing-xs);\n}\n\n.current-suggestions {\n    display: flex;\n    flex-wrap: wrap;\n    gap: var(--spacing-xs);\n}\n\n.current-suggestions .command {\n    color: var(--color-primary);\n    opacity: 0.8;\n    margin: 0 var(--spacing-xs);\n}\n\n.show-all-commands {\n    font-size: var(--font-size-sm);\n    color: var(--color-primary);\n    background: none;\n    border: none;\n    cursor: pointer;\n    text-decoration: underline;\n    padding: 0;\n    margin-top: var(--spacing-sm);\n}\n\n.show-all-commands:hover {\n    text-decoration: none;\n}\n\n/* Commands Panel */\n.commands-panel {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    background-color: var(--color-white);\n    box-shadow: var(--shadow-lg);\n    border-top-left-radius: var(--border-radius-lg);\n    border-top-right-radius: var(--border-radius-lg);\n    padding: var(--spacing-md);\n    transform: translateY(100%);\n    transition: transform var(--transition-base);\n    z-index: 1000;\n    max-height: 80vh;\n    overflow-y: auto;\n}\n\n.commands-panel.active {\n    transform: translateY(0);\n}\n\n.commands-panel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: var(--spacing-md);\n    border-bottom: 1px solid var(--color-border);\n    padding-bottom: var(--spacing-sm);\n}\n\n.commands-panel h3 {\n    color: var(--color-primary);\n    margin: 0;\n}\n\n.commands-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: var(--spacing-md);\n}\n\n.command-category {\n    background-color: var(--color-timer-background);\n    border-radius: var(--border-radius-md);\n    padding: var(--spacing-md);\n}\n\n.command-category h4 {\n    color: var(--color-primary);\n    margin-bottom: var(--spacing-sm);\n    border-bottom: 1px solid var(--color-border);\n    padding-bottom: var(--spacing-xs);\n}\n\n.command-category ul {\n    list-style-type: none;\n    padding: 0;\n}\n\n.command-category li {\n    margin-bottom: var(--spacing-xs);\n    line-height: 1.4;\n}\n\n.command-category .command {\n    background-color: var(--color-timer-background);\n    color: var(--color-primary);\n    padding: var(--spacing-xs) var(--spacing-sm);\n    border-radius: var(--border-radius-sm);\n    font-family: monospace;\n    margin-right: var(--spacing-xs);\n}",""]);const a=s},659:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},668:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Common Button Styles */\n.primary-button,\n.secondary-button {\n    padding: var(--spacing-sm) var(--spacing-xl);\n    border-radius: var(--border-radius-sm);\n    font-size: var(--font-size-base);\n    cursor: pointer;\n    font-family: var(--font-family-primary);\n    transition: all var(--transition-base);\n}\n\n.primary-button {\n    background-color: var(--color-primary);\n    color: var(--color-white);\n    border: none;\n}\n\n.secondary-button {\n    background-color: var(--color-background);\n    color: var(--color-primary);\n    border: 1px solid var(--color-primary);\n}\n\n.primary-button:hover {\n    background-color: #8b3e00;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-md);\n}\n\n.secondary-button:hover {\n    background-color: #f5efe7;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-sm);\n}\n\n/* Common Container Styles */\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: var(--spacing-md);\n    font-family: var(--font-family-primary);\n}\n\n/* Common Back Button */\n.back-button {\n    display: inline-block;\n    margin-bottom: var(--spacing-md);\n    color: var(--color-primary);\n    text-decoration: none;\n    font-size: var(--font-size-lg);\n    transition: color var(--transition-base);\n}\n\n.back-button:hover {\n    text-decoration: underline;\n}\n\n/* Common Error Message */\n.error-message {\n    background-color: var(--color-background);\n    color: var(--color-primary);\n    padding: var(--spacing-md);\n    border-radius: var(--border-radius-md);\n    margin-bottom: var(--spacing-md);\n    font-family: var(--font-family-primary);\n    border: 1px solid var(--color-border);\n}",""]);const a=s},694:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Basic Reset */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n/* Default body styles */\nbody {\n    font-family: var(--font-family-primary), -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    line-height: 1.6;\n    background-color: var(--color-background);\n    color: var(--color-text);\n    font-size: var(--font-size-base);  /* Using the base font size variable */\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 0 var(--spacing-md);\n}",""]);const a=s},763:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,'/* Shopping List Modal */\n.shopping-list-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.shopping-list-content {\n    background-color: var(--color-white);\n    border-radius: var(--border-radius-lg);\n    padding: var(--spacing-xl);\n    width: 90%;\n    max-width: 600px;\n    max-height: 80vh;\n    overflow-y: auto;\n    position: relative;\n    box-shadow: var(--shadow-lg);\n}\n\n.shopping-list-content h2 {\n    color: var(--color-primary);\n    font-size: var(--font-size-xl);\n    margin-bottom: var(--spacing-lg);\n    font-family: var(--font-family-primary);\n}\n\n.shopping-list-items {\n    list-style: none;\n    padding: 0;\n    margin: 0 0 var(--spacing-xl) 0;\n}\n\n.shopping-list-category {\n    margin-bottom: var(--spacing-lg);\n}\n\n.shopping-list-category h3 {\n    color: var(--color-primary);\n    font-size: var(--font-size-lg);\n    margin-bottom: var(--spacing-sm);\n    padding-bottom: var(--spacing-xs);\n    border-bottom: 1px solid var(--color-border);\n}\n\n.shopping-list-category ul {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n}\n\n.shopping-list-category li {\n    padding: var(--spacing-xs) 0;\n    color: var(--color-text);\n    display: flex;\n    align-items: center;\n}\n\n.shopping-list-category li::before {\n    content: "•";\n    color: var(--color-primary);\n    margin-right: var(--spacing-sm);\n}\n\n.close-btn {\n    position: absolute;\n    top: var(--spacing-md);\n    right: var(--spacing-md);\n    font-size: var(--font-size-xl);\n    color: var(--color-text-light);\n    cursor: pointer;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    transition: all var(--transition-base);\n}\n\n.close-btn:hover {\n    background-color: var(--color-background);\n    color: var(--color-primary);\n}\n\n.shopping-list-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: var(--spacing-md);\n    margin-top: var(--spacing-lg);\n    padding-top: var(--spacing-md);\n    border-top: 1px solid var(--color-border);\n}\n\n/* Print styles */\n@media print {\n    .shopping-list-modal {\n        position: static;\n        background: none;\n        display: block;\n    }\n\n    .shopping-list-content {\n        box-shadow: none;\n        max-width: 100%;\n        padding: 0;\n    }\n\n    .close-btn,\n    .shopping-list-actions {\n        display: none;\n    }\n\n    .shopping-list-category {\n        break-inside: avoid;\n    }\n}',""]);const a=s},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},936:(e,t,n)=>{n.d(t,{M:()=>r});var i=n(548);class r{constructor({id:e,name:t,duration:n,onComplete:i,metadata:r={}}){this.id=e,this.name=t,this.duration=n,this.remaining=n,this.interval=null,this._isRunning=!1,this.status="idle",this.startTime=null,this.pauseTime=null,this.completion=0,this.createTime=new Date,this.metadata=r,this.onComplete=i}start(){console.log(`Timer.start() called for timer: ${this.id} (${this.name})`),this._isRunning?console.log(`Timer ${this.id} already running, ignoring start call`):(console.log(`Setting timer ${this.id} to running state`),this._isRunning=!0,this.status="running",this.startTime=new Date,console.log(`Setting interval for timer ${this.id}`),this.interval&&(console.log(`Clearing existing interval for timer ${this.id}`),clearInterval(this.interval)),this.interval=setInterval((()=>{this.remaining--,this.completion=(this.duration-this.remaining)/this.duration*100,(this.remaining%10==0||this.remaining<=5)&&console.log(`Timer ${this.id} tick: ${this.remaining}s remaining`),this.remaining<=0&&(console.log(`Timer ${this.id} completed via interval`),this.complete())}),1e3),console.log(`Timer ${this.id} started successfully`))}pause(){this._isRunning&&(this._isRunning=!1,this.status="paused",this.pauseTime=new Date,clearInterval(this.interval))}reset(){this.pause(),this.remaining=this.duration,this.status="idle",this.startTime=null,this.pauseTime=null,this.completion=0}complete(){this.pause(),this.status="completed",this.remaining=0,this.completion=100,this.onComplete&&this.onComplete()}getRemainingTime(){return this.remaining}getFormattedTime(){return(0,i.LU)(this.remaining)}getStatus(){return this.status}getCompletion(){return this.completion}getMetadata(){return this.metadata}addMetadata(e){this.metadata={...this.metadata,...e}}rename(e){this.name=e}cleanup(){this.interval&&clearInterval(this.interval)}get isComplete(){return"completed"===this.status}get isRunning(){return this._isRunning}get isPaused(){return"paused"===this.status}get remainingTime(){return this.remaining}}},949:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([e.id,"/* Loading State Styles */\n.loading-container {\n    text-align: center;\n    padding: 2rem;\n}\n\n.loading-spinner {\n    border: 4px solid var(--color-background);\n    border-top: 4px solid var(--color-primary);\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    animation: spin 1s linear infinite;\n    margin: 0 auto 1rem;\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n/* Error State Styles */\n.error-message {\n    display: none;\n    padding: 2rem;\n    text-align: center;\n    background-color: var(--color-error-bg);\n    border-radius: var(--border-radius);\n    margin: 2rem 0;\n}\n\n.error-content {\n    max-width: 600px;\n    margin: 0 auto;\n}\n\n.error-details {\n    color: var(--color-error);\n    margin: 1rem 0;\n    font-family: var(--font-mono);\n    font-size: 0.9rem;\n}\n\n.error-actions {\n    margin-top: 1rem;\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n}\n\n/* Button Styles for States */\n.btn {\n    padding: 0.5rem 1rem;\n    border-radius: var(--border-radius-sm);\n    cursor: pointer;\n    border: none;\n    font-weight: 500;\n    transition: background-color 0.2s ease;\n}\n\n.btn.retry {\n    background-color: var(--color-primary);\n    color: white;\n}\n\n.btn.retry:hover {\n    background-color: var(--color-primary-dark);\n}\n\n.btn.home {\n    background-color: var(--color-secondary);\n    color: white;\n}\n\n.btn.home:hover {\n    background-color: var(--color-secondary-dark);\n} ",""]);const a=s}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={id:e,exports:{}};return n[e](o,o.exports,r),o.exports}r.m=n,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+".bundle.js",r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="recipe-viewer:",r.l=(n,i,o,s)=>{if(e[n])e[n].push(i);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var m=l[d];if(m.getAttribute("src")==n||m.getAttribute("data-webpack")==t+o){a=m;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+o),a.src=n),e[n]=[i];var p=(t,i)=>{a.onerror=a.onload=null,clearTimeout(u);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),t)return t(i)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/recipe_viewer/",(()=>{var e={845:0};r.f.j=(t,n)=>{var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=o);var s=r.p+r.u(t),a=new Error;r.l(s,(n=>{if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,o,[s,a,c]=n,l=0;if(s.some((t=>0!==e[t]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);c&&c(r)}for(t&&t(n);l<s.length;l++)o=s[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkrecipe_viewer=self.webpackChunkrecipe_viewer||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0;const o={development:{recipesPath:"/assets/recipes",imagePath:"/assets/images"},production:{recipesPath:"/recipe_viewer/assets/recipes",imagePath:"/recipe_viewer/assets/images"}}["undefined"==typeof window||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||""===window.location.hostname?"development":"production"];console.log("Recipe Data configuration:",o);class s{constructor(){this.recognition=null,this.isListening=!1,this.commands=new Map,this.isSpeaking=!1,this.ignoreSpeechEvents=!1,this.pausedReading=null,this.availableCommands=[],this.currentStepIndex=0,this.currentRecipeSteps=null,this.statusElement=document.getElementById("voice-status");try{this.eventBus=window.eventBus,this.eventBus||(console.log("No global event bus found, importing from module"),Promise.resolve().then(r.bind(r,48)).then((e=>{this.eventBus=e.default,console.log("Event bus imported for voice control")})))}catch(e){console.error("Error accessing event bus:",e)}this.initializeSpeechRecognition()}initializeSpeechRecognition(){if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window))return console.error("Speech recognition not supported"),void this.updateStatus("Voice commands not supported in this browser","error");const e=window.webkitSpeechRecognition||window.SpeechRecognition;this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!1,this.recognition.lang="en-US",this.recognition.maxAlternatives=3,this.recognition.onresult=e=>{const t=e.results.length-1,n=e.results[t][0].transcript.trim().toLowerCase();console.log(`Recognition result: "${n}" (confidence: ${e.results[t][0].confidence.toFixed(2)})`);const i=n.includes("voice control activated")||n.includes("voice control deactivated")||n.includes("command not recognized")||n.includes("not recognized")||/^hear(d|ing)?:?\s/i.test(n)||/^(command|voice)?\s?not\s(recognized|recognize)/i.test(n);if(!i&&(this.updateStatus(`Heard: "${n}"`,"active"),e.results[t].length>1))for(let n=1;n<e.results[t].length;n++)console.log(`Alternative ${n}: "${e.results[t][n].transcript.trim().toLowerCase()}" (confidence: ${e.results[t][n].confidence.toFixed(2)})`);if(/.*(stop|pause).*read.*/i.test(n))return console.log("Processing stop/pause reading command even during speech"),void this.stopSpeaking();this.ignoreSpeechEvents?console.log("Ignoring speech recognition result during feedback"):i||(this.processCommand(n),setTimeout((()=>{this.isListening&&!this.isSpeaking&&this.updateStatus("Voice commands ready","active")}),3e3))},this.recognition.onerror=e=>{console.error("Speech recognition error:",e.error),"no-speech"!==e.error&&(this.stop(),this.updateStatus(`Voice recognition error: ${e.error}`,"error"))},this.recognition.onend=()=>{if(this.isListening){console.log("Recognition ended, restarting...");try{this.recognition.start()}catch(e){console.error("Error restarting recognition:",e),this.isListening=!1,this.updateStatus("Voice recognition stopped due to error","error")}}}}updateStatus(e,t=null){(this.statusElement||(this.statusElement=document.getElementById("voice-status"),this.statusElement))&&(["command not recognized","not recognized","voice control activated","voice control deactivated"].some((t=>e.toLowerCase().includes(t)))&&"error"!==t||(this.statusElement.textContent=e,t&&(this.statusElement.classList.remove("active","inactive","error"),this.statusElement.classList.add(t))))}start(){if(this.recognition){this.isListening=!0;try{this.recognition.start(),console.log("Voice recognition started"),this.ignoreSpeechEvents=!0,this.updateStatus("Voice control activated","active"),setTimeout((()=>{this.ignoreSpeechEvents=!1,this.updateStatus("Voice commands ready","active")}),500)}catch(e){console.error("Error starting speech recognition:",e),this.isListening=!1,this.updateStatus("Error starting voice recognition","error")}}}stop(){if(this.recognition){this.isListening=!1;try{this.recognition.stop(),console.log("Voice recognition stopped"),this.updateStatus("Voice control deactivated","inactive"),setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)}catch(e){console.error("Error stopping speech recognition:",e),this.updateStatus("Error stopping voice recognition","error")}}}isEnabled(){return this.isListening}addCommands(e){for(const[t,n]of Object.entries(e)){this.availableCommands.push(t);const e=this.phraseToPattern(t);this.commands.set(e,n),console.log(`Added voice command: ${t}`)}}getAvailableCommands(){return this.availableCommands}processCommand(e){console.log("Processing voice command:",e);let t=!1;if(e.includes("voice control activated")||e.includes("voice control deactivated")||e.includes("command not recognized")||e.includes("not recognized")||/hear(d|ing)?:?\s/i.test(e)||/^(command|voice)?\s?not\s(recognized|recognize)/i.test(e))console.log("Skipping system feedback phrase:",e);else if(/(start|create|set|pause|stop|reset|restart|cancel|clear|remove|close)\s+(?:.+?)(?:\s+timer)?/i.test(e))if(console.log("Detected timer command, forwarding to timer command interface"),console.log(`Event bus available: ${!!this.eventBus}`),this.eventBus){if(console.log(`Publishing timer:command:process event with command: "${e}"`),this.eventBus.publish("timer:command:process",{command:e}),window.timerModule&&window.timerModule.timerCommandInterface){console.log("Also trying direct access to timerCommandInterface");try{window.timerModule.timerCommandInterface.processCommand(e)}catch(e){console.error("Error directly accessing timer command interface:",e)}}}else console.error("Event bus not available for timer command processing");else{if(e.includes("what can i say")||e.includes("what commands")||e.includes("show commands")||e.includes("available commands")||e.includes("what can i do")||e.includes("help")&&e.length<10){console.log("Help command detected:",e);for(const[e,n]of this.commands)if(e.toString().includes("what can I say")||e.toString().includes("show commands")||e.toString().includes("available commands")||e.toString().includes("help"))return console.log("Executing help command callback"),n(),void(t=!0)}console.log("Available command patterns:");for(const[e,t]of this.commands)console.log(`- ${e}`);for(const[n,i]of this.commands)if(console.log(`Testing command "${e}" against pattern: ${n}`),n.test(e)){console.log(`Command matched pattern: ${n}`),i(),t=!0;break}t||(console.log("Command not recognized"),this.updateStatus(`Command not recognized: "${e}"`,"error"),setTimeout((()=>{this.isListening&&this.updateStatus("Voice commands ready","active")}),3e3))}}phraseToPattern(e){const t=e.replace(/\((.*?)\)/g,"(?:$1)?").replace(/\s+/g,"\\s+");if(["what can I say","show commands","available commands","help"].includes(e))return new RegExp(`.*${t}.*`,"i");const n=new RegExp(`.*${t}.*`,"i");return console.log(`Converting phrase "${e}" to pattern: ${n}`),n}speak(e,t=null){window.speechSynthesis.cancel(),this.isSpeaking=!0,this.updateStatus("Reading in progress (voice commands paused)","active"),"Command not recognized"===e&&(e="I didn't understand that command");const n=new SpeechSynthesisUtterance(e);n.volume=.8,n.rate=1,n.onend=t?()=>{this.isSpeaking=!1,t(),this.isListening&&this.updateStatus("Voice commands ready","active")}:()=>{this.isSpeaking=!1,this.isListening&&this.updateStatus("Voice commands ready","active")},window.speechSynthesis.speak(n)}speakWithOptions(e,t=.8,n=1,i=null){window.speechSynthesis.cancel(),this.isSpeaking=!0,this.updateStatus("Reading in progress (voice commands paused)","active");const r=new SpeechSynthesisUtterance(e);return r.volume=t,r.rate=n,r.onend=i?()=>{this.isSpeaking=!1,i(),this.isListening&&this.updateStatus("Voice commands ready","active")}:()=>{this.isSpeaking=!1,this.isListening&&this.updateStatus("Voice commands ready","active")},window.speechSynthesis.speak(r),r}speakWithPauses(e,t=800){const n=e.split(/(?<=[.!?])\s+/);if(0===n.length)return;this.isSpeaking=!0;let i=0;const r=()=>{if(i>=n.length)return void(this.isSpeaking=!1);const e=n[i].trim();if(!e)return i++,void r();const o=new SpeechSynthesisUtterance(e);o.volume=.8,o.rate=1,o.onend=()=>{i<n.length-1?(i++,setTimeout(r,t)):this.isSpeaking=!1},window.speechSynthesis.speak(o)};r()}readStep(e){if(e)if(this.currentReadingStep=e,this.stopSpeaking(),e.description){this.isSpeaking=!0,this.ignoreSpeechEvents=!0,this.updateStatus("Reading in progress (voice commands paused)","active");const t=new SpeechSynthesisUtterance(e.description);t.volume=.8,t.rate=1,t.onend=()=>{setTimeout((()=>{this.isSpeaking&&this.readBulletPoints(e.bullets||[])}),1e3)},window.speechSynthesis.speak(t)}else this.readBulletPoints(e.bullets||[])}pauseReading(){return!!this.isSpeaking&&(console.log("Pausing reading"),this.isSpeaking=!1,window.speechSynthesis.pause(),this.pausedReading=!0,this.updateStatus("Reading paused (voice commands ready)","active"),!0)}resumeReading(){return!!this.pausedReading&&(console.log("Resuming reading"),this.isSpeaking=!0,window.speechSynthesis.resume(),this.pausedReading=!1,this.updateStatus("Reading in progress (voice commands paused)","active"),!0)}readBulletPoints(e,t=800){if(!e||0===e.length)return this.isSpeaking=!1,this.ignoreSpeechEvents=!1,void(this.isListening&&this.updateStatus("Voice commands ready","active"));this.isSpeaking=!0,this.ignoreSpeechEvents=!0,this.updateStatus("Reading in progress (voice commands paused)","active");const n=i=>{if(i>=e.length)return this.isSpeaking=!1,void setTimeout((()=>{this.ignoreSpeechEvents=!1,this.isListening&&this.updateStatus("Voice commands ready","active")}),500);if(!this.isSpeaking)return void(this.ignoreSpeechEvents=!1);const r=new SpeechSynthesisUtterance(e[i]);r.volume=.8,r.rate=1,r.onend=()=>{this.isSpeaking&&setTimeout((()=>{n(i+1)}),t)},window.speechSynthesis.speak(r)};n(0)}readAllSteps(e){if(!e||0===e.length)return;this.currentReadingAllSteps=e,this.currentRecipeSteps=e,this.stopSpeaking(),this.isSpeaking=!0,this.ignoreSpeechEvents=!1,this.updateStatus("Reading in progress (voice commands paused)","active");const t=n=>{if(n>=e.length)return this.isSpeaking=!1,void(this.isListening&&this.updateStatus("Voice commands ready","active"));if(!this.isSpeaking)return;const i=e[n];let r=`Step ${n+1}: ${i.description||""}`;const o=new SpeechSynthesisUtterance(r);o.volume=.8,o.rate=1,o.onend=()=>{if(this.isSpeaking)if(i.bullets&&i.bullets.length>0){let r=0;const o=()=>{if(r>=i.bullets.length)return void setTimeout((()=>{if(this.isSpeaking&&n<e.length-1){const e=new SpeechSynthesisUtterance("Next step");e.onend=()=>{this.isSpeaking&&setTimeout((()=>t(n+1)),500)},window.speechSynthesis.speak(e)}else this.isSpeaking=!1,this.isListening&&this.updateStatus("Voice commands ready","active")}),1e3);if(!this.isSpeaking)return;const s=new SpeechSynthesisUtterance(i.bullets[r]);s.volume=.8,s.rate=1,s.onend=()=>{this.isSpeaking&&setTimeout((()=>{r++,o()}),800)},window.speechSynthesis.speak(s)};this.isSpeaking&&setTimeout(o,800)}else setTimeout((()=>{if(this.isSpeaking&&n<e.length-1){const e=new SpeechSynthesisUtterance("Next step");e.onend=()=>{this.isSpeaking&&setTimeout((()=>t(n+1)),500)},window.speechSynthesis.speak(e)}else this.isSpeaking=!1,this.isListening&&this.updateStatus("Voice commands ready","active")}),1500)},window.speechSynthesis.speak(o)};t(0)}stopSpeaking(){return!!this.isSpeaking&&(console.log("Stopping all speech"),window.speechSynthesis.cancel(),this.isSpeaking=!1,this.pausedReading=!1,this.isListening&&this.updateStatus("Voice commands ready","active"),this.currentReadingStep=null,this.currentReadingAllSteps=null,setTimeout((()=>{this.ignoreSpeechEvents=!1}),500),!0)}announceStep(e){if(!e)return;let t="";"preparation"===e.phase?t="Preparation step":"cooking"===e.phase&&(t="Cooking step"),this.ignoreSpeechEvents=!0,this.speak(t,(()=>{setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)}))}cleanup(){if(this.recognition)try{this.stop(),this.stopSpeaking(),this.commands.clear(),this.availableCommands=[],console.log("Voice control cleaned up")}catch(e){console.error("Error cleaning up voice control:",e)}}playCommandRecognizedSound(){console.log("Command recognized (sound disabled)")}playFallbackBeep(){console.log("Fallback beep disabled")}navigateToNextStep(){return this.currentRecipeSteps&&0!==this.currentRecipeSteps.length?(this.stopSpeaking(),this.currentStepIndex>=this.currentRecipeSteps.length-1?(this.ignoreSpeechEvents=!0,this.speak("You are at the last step",(()=>{setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)})),!1):(this.currentStepIndex++,this.ignoreSpeechEvents=!0,this.speak(`Moved to step ${this.currentStepIndex+1}`,(()=>{setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)})),!0)):(console.log("No recipe steps available for navigation"),!1)}navigateToPreviousStep(){return this.currentRecipeSteps&&0!==this.currentRecipeSteps.length?(this.stopSpeaking(),this.currentStepIndex<=0?(this.ignoreSpeechEvents=!0,this.speak("You are at the first step",(()=>{setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)})),!1):(this.currentStepIndex--,this.ignoreSpeechEvents=!0,this.speak(`Moved to step ${this.currentStepIndex+1}`,(()=>{setTimeout((()=>{this.ignoreSpeechEvents=!1}),500)})),!0)):(console.log("No recipe steps available for navigation"),!1)}readCurrentStep(e){if(!e)return console.log("No step provided to read"),!1;if(this.currentReadingStep=e,this.stopSpeaking(),this.isSpeaking=!0,this.ignoreSpeechEvents=!0,this.updateStatus("Reading in progress (voice commands paused)","active"),e.description){const t=new SpeechSynthesisUtterance(e.description);t.volume=.8,t.rate=1,t.onend=()=>{this.isSpeaking&&e.bullets&&e.bullets.length>0?setTimeout((()=>{this.readBulletPoints(e.bullets)}),800):(this.isSpeaking=!1,setTimeout((()=>{this.ignoreSpeechEvents=!1,this.isListening&&this.updateStatus("Voice commands ready","active")}),500))},window.speechSynthesis.speak(t)}else{if(!(e.bullets&&e.bullets.length>0))return this.isSpeaking=!1,this.ignoreSpeechEvents=!1,this.isListening&&this.updateStatus("Voice commands ready","active"),!1;this.readBulletPoints(e.bullets)}return!0}}r(548);var a=r(48),c=r(281),l=(r(165),r(72)),d=r.n(l),m=r(825),p=r.n(m),u=r(659),h=r.n(u),g=r(56),v=r.n(g),b=r(540),f=r.n(b),y=r(113),x=r.n(y),S=r(249),w={};w.styleTagTransform=x(),w.setAttributes=v(),w.insert=h().bind(null,"head"),w.domAPI=p(),w.insertStyleElement=f(),d()(S.A,w),S.A&&S.A.locals&&S.A.locals;const k=new class{constructor(){this.eventBus=a.default,this.recipe=null,this.steps=[],this.currentStep=0,this.currentPhase="preparation",this.elements={},this.voiceControl=null,this.initialized=!1,this.init=this.init.bind(this),this.loadRecipe=this.loadRecipe.bind(this),this.updateStep=this.updateStep.bind(this),this.nextStep=this.nextStep.bind(this),this.previousStep=this.previousStep.bind(this),this.exitCookingMode=this.exitCookingMode.bind(this)}async init(e={}){try{if(this.initialized)return console.log("Cooking mode already initialized, skipping"),!0;console.log("Starting cooking mode initialization");const e=new URLSearchParams(window.location.search);if(this.recipeId=e.get("id"),!this.recipeId)return console.error("No recipe ID found in URL"),this.showError("No recipe ID provided"),!1;if(console.log("Recipe ID from URL:",this.recipeId),this.cleanupExistingState(),this.initializeElements(),this.bindEvents(),await this.initializeVoiceControl(),c.Ay&&"function"==typeof c.Ay.initialize)try{console.log("Initializing timer module from cooking mode");try{localStorage.removeItem("recipe-viewer-timers"),console.log("Cleared timer storage before initialization")}catch(e){console.error("Error clearing timer storage:",e)}await c.Ay.initialize({enableUi:!0,keepExistingTimers:!1,autoAdvanceOnComplete:!!this.recipe?.settings?.autoAdvanceOnTimer,onTimerComplete:(e,t)=>{this.recipe?.settings?.autoAdvanceOnTimer&&t?.metadata?.stepId===this.currentStep&&this.nextStep()}}),console.log("Timer module initialized successfully")}catch(e){console.error("Error initializing timer module:",e)}else console.error("Timer module not available or missing initialize method");if(this.currentStep=0,this.currentPhase="preparation",this.steps=[],await this.loadRecipe(),this.updateStep(),this.initialized=!0,console.log("Cooking mode initialized successfully"),window.location.search.includes("test-timers=true")&&this._runTimerTests(),!document.querySelector('link[href*="font-awesome"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css",document.head.appendChild(e),console.log("Added FontAwesome for timer icons")}return!0}catch(e){return this.showError("Error initializing cooking mode: "+e.message),console.error("Error initializing cooking mode:",e),!1}}isInitialized(){return this.initialized}cleanupExistingState(){if(console.log("Cleaning up existing state"),c.Ay)try{console.log("Attempting to clear all timers from cooking mode"),"function"==typeof c.Ay.clearAllTimers&&c.Ay.clearAllTimers(),"function"==typeof c.Ay.clearProcessedSteps&&c.Ay.clearProcessedSteps(),this.eventBus&&(this.eventBus.publish("timer:request:clear",{}),this.eventBus.publish("timers:cleared",null)),setTimeout((()=>{try{"function"==typeof c.Ay.clearAllTimers&&c.Ay.clearAllTimers(),localStorage.removeItem("recipe-viewer-timers"),console.log("Cleared timer storage directly")}catch(e){console.error("Error in delayed timer cleanup:",e)}}),100)}catch(e){console.error("Error clearing timers:",e);try{localStorage.removeItem("recipe-viewer-timers"),console.log("Emergency timer storage cleanup completed")}catch(e){console.error("Failed emergency timer cleanup:",e)}}this.unbindEvents(),this.currentStepIndex=0,this.currentPhase=null,this.currentPhaseStepNumber=0,this.lastUsedStepId=null,this.recipeData=null,this.recipeSteps=null,this.recipePrepSteps=null,this.recipeCookSteps=null}initializeElements(){if(this.elements={title:document.getElementById("recipe-title"),stepTitle:document.getElementById("step-title"),stepNumber:document.getElementById("step-number"),currentStep:document.getElementById("current-step"),stepDetails:document.getElementById("step-details"),prevButton:document.getElementById("prev-step"),nextButton:document.getElementById("next-step"),readButton:document.getElementById("read-step"),exitButton:document.getElementById("exit-cooking"),timerContainer:document.getElementById("timer-container"),progressBar:document.getElementById("progress-indicator"),phaseIndicators:document.querySelectorAll(".phase-indicator"),voiceToggle:document.getElementById("toggle-voice"),voiceStatus:document.getElementById("voice-status"),showCommandsBtn:document.getElementById("show-commands"),commandsPanel:document.getElementById("commands-panel")},this.elements.readButton&&(this.elements.readButton.textContent="Read Step"),this.elements.readButton&&this.elements.readButton.parentNode){const e=document.createElement("button");e.id="pause-read",e.className="nav-button secondary-button",e.textContent="Pause Read",this.elements.readButton.parentNode.insertBefore(e,this.elements.readButton.nextSibling),this.elements.pauseReadButton=e}["title","stepTitle","stepNumber","currentStep","stepDetails","prevButton","nextButton","readButton","exitButton","timerContainer","progressBar"].forEach((e=>{this.elements[e]||console.error(`Missing required element: ${e}`)}))}bindEvents(){this.elements.prevButton.addEventListener("click",(()=>this.previousStep())),this.elements.nextButton.addEventListener("click",(()=>this.nextStep())),this.elements.readButton.addEventListener("click",(()=>this.readCurrentStep())),this.elements.exitButton.addEventListener("click",(e=>{e.preventDefault(),this.exitCookingMode()})),this.elements.pauseReadButton&&this.elements.pauseReadButton.addEventListener("click",(()=>{this.voiceControl&&this.voiceControl.stopSpeaking()})),this.elements.voiceToggle&&this.elements.voiceToggle.addEventListener("click",(()=>{this.voiceControl&&(this.voiceControl.isEnabled()?(this.voiceControl.stop(),this.updateVoiceControlUI(!1)):(this.voiceControl.start(),this.updateVoiceControlUI(!0)))})),this.elements.phaseIndicators.forEach((e=>{e.addEventListener("click",(()=>{const t=e.dataset.phase;this.jumpToPhase(t)}))})),this.elements.showCommandsBtn&&this.elements.showCommandsBtn.addEventListener("click",(()=>{this.showAvailableCommands()}))}unbindEvents(){this.elements.prevButton&&this.elements.prevButton.removeEventListener("click",this.previousStep),this.elements.nextButton&&this.elements.nextButton.removeEventListener("click",this.nextStep),this.elements.readButton&&this.elements.readButton.removeEventListener("click",this.readCurrentStep),this.elements.exitButton&&this.elements.exitButton.removeEventListener("click",this.exitCookingMode),this.elements.pauseReadButton&&this.elements.pauseReadButton.removeEventListener("click",(()=>{})),this.elements.voiceToggle&&this.elements.voiceToggle.removeEventListener("click",(()=>{}))}async initializeVoiceControl(){try{this.voiceControl=new s,this.setupVoiceCommands(),this.updateVoiceControlUI(!1),console.log("Voice control initialized successfully")}catch(e){console.error("Failed to initialize voice control:",e),this.voiceControl=null,this.elements.voiceStatus&&(this.elements.voiceStatus.textContent="Voice commands are not available on this browser",this.elements.voiceStatus.classList.add("error")),this.elements.voiceToggle&&(this.elements.voiceToggle.disabled=!0,this.elements.voiceToggle.textContent="Voice Commands Not Available"),this.elements.showCommandsBtn&&(this.elements.showCommandsBtn.disabled=!0)}}async loadRecipe(){try{if(console.log("Current URL:",window.location.href),console.log("URL Path:",window.location.pathname),console.log("URL Search:",window.location.search),this.recipeId)console.log("Recipe ID from URL parameter:",this.recipeId);else{const e=window.location.pathname.match(/\/cooking\/([^\/]+)/);e&&e[1]&&(this.recipeId=e[1],console.log("Found recipe ID in URL path:",this.recipeId))}if(!this.recipeId)return console.error("No recipe ID found in URL. Please select a recipe first."),void this.showError("No recipe ID found. Please select a recipe first.");console.log("Loading recipe with ID:",this.recipeId);const e=await async function(e){try{if(!e)throw new Error("Recipe ID is required");const t=function(e){return e?e.startsWith("recipe-")?e:`recipe-${e}`:e}(e);console.log(`Loading recipe with normalized ID: ${t}`);const n=`${o.recipesPath}/${t}.json`;console.log(`Fetching recipe from JSON file: ${n}`);const i=await fetch(n);if(console.log(`JSON file response status: ${i.status}`),!i.ok)throw new Error(`Failed to load recipe: ${i.status} ${i.statusText}`);const r=await i.json();if(console.log(`Recipe data loaded with title: ${r.title}`),!r.title||!r.metadata||!r.ingredients)throw console.error("Invalid recipe data format. Missing required fields:",{hasTitle:!!r.title,hasMetadata:!!r.metadata,hasIngredients:!!r.ingredients}),new Error("Invalid recipe data format");return r}catch(e){throw console.error("Error loading recipe:",e),e}}(this.recipeId);console.log("Recipe loaded successfully:",e.title),this.recipe=e;const t=(e.preparationSteps||[]).map((e=>({...e,phase:"preparation",description:e.mainStep||"",bullets:e.bullets||[]}))),n=(e.cookingSteps||[]).map((e=>({...e,phase:"cooking",description:e.mainStep||"",bullets:e.bullets||[]})));this.steps=[...t,...n],console.log(`Recipe has ${this.steps.length} total steps (${t.length} prep, ${n.length} cooking)`),this.currentStep=0,this.currentPhase="preparation",this.updateStep(),this.updatePhaseIndicator()}catch(e){console.error("Error loading recipe:",e),this.showError(`Error loading recipe: ${e.message}`)}}updateStep(){const e=this.steps[this.currentStep];if(!e)return void console.error("No step found at index:",this.currentStep);this.currentPhase!==e.phase&&(this.currentPhase=e.phase),this.updatePhaseIndicator(),document.body.dataset.currentStepId=this.currentStep.toString(),document.body.dataset.currentPhase=this.currentPhase;const t=this.getCurrentPhaseStepNumber(),n="preparation"===this.currentPhase?"Preparation":"Cooking";document.body.dataset.currentPhaseStepNumber=t.toString(),this.elements.stepTitle.textContent=`${n} Step ${t}`,this.elements.stepNumber.textContent=`Step ${t} of ${this.getTotalPhaseSteps()}`,this.elements.currentStep.textContent=e.description,e.bullets&&e.bullets.length>0?this.elements.stepDetails.innerHTML=e.bullets.map((e=>`<li>${e}</li>`)).join(""):this.elements.stepDetails.innerHTML="",this.elements.prevButton.disabled=0===this.currentStep,this.currentStep===this.steps.length-1?(this.elements.nextButton.textContent="Bon Appétit!",this.elements.nextButton.disabled=!0,this.elements.nextButton.classList.add("bon-appetit")):(this.elements.nextButton.textContent="Next Step",this.elements.nextButton.disabled=!1,this.elements.nextButton.classList.remove("bon-appetit"));const i=(this.currentStep+1)/this.steps.length*100;this.elements.progressBar.style.width=`${i}%`;try{"function"==typeof c.Ay.highlightStep?c.Ay.highlightStep(this.currentStep):console.error("timerModule.highlightStep is not a function",c.Ay)}catch(e){console.error("Error highlighting step:",e)}this.checkStepForTimers(e)}checkStepForTimers(e){if(e)if(console.log("Checking step for timers",e),c.Ay&&"function"==typeof c.Ay.createTimersForStep){const t={stepIndex:this.currentStep,phase:this.currentPhase,phaseStepNumber:this.getCurrentPhaseStepNumber()};c.Ay.createTimersForStep(e,t).then((e=>{console.log(`Timer module created ${e.filter((e=>null!==e)).length} timers for step ${this.currentStep}`)})).catch((e=>{console.error("Error creating timers for step:",e)}))}else console.error("Timer module createTimersForStep not available")}jumpToPhase(e){const t=this.steps.findIndex((t=>t.phase===e));-1!==t&&(this.currentStep=t,this.currentPhase=e,this.updateStep())}nextStep(){try{const e=this.getPhaseSteps();if(!e||0===e.length)return void console.error(`No steps found for ${this.currentPhase} phase.`);const t=this.getCurrentPhaseStepNumber();if(console.log(`Current phase step number: ${t}`),t<e.length)return console.log(`Moving to next step in ${this.currentPhase} phase: ${t}`),void this.loadPhaseStep(t);if("preparation"===this.currentPhase){const e=this.getPhaseSteps("cooking");if(e&&e.length>0)return console.log("Moving from preparation to cooking phase"),this.currentPhase="cooking",this.loadPhaseStep(0),void this.updatePhaseIndicator()}console.log("End of all steps reached, showing recipe summary"),this.showRecipeSummary()}catch(e){console.error("Error navigating to next step:",e)}}previousStep(){try{const e=this.getPhaseSteps();if(!e||0===e.length)return void console.error(`No steps found for ${this.currentPhase} phase.`);const t=this.steps[this.currentStep],n=e.findIndex((e=>e===t));if(console.log(`Current position in ${this.currentPhase} phase: ${n}`),n>0)return console.log(`Moving to previous step in ${this.currentPhase} phase: ${n-1}`),void this.loadPhaseStep(n-1);if("cooking"===this.currentPhase){const e=this.getPhaseSteps("preparation");if(e&&e.length>0)return console.log("Moving from cooking back to preparation phase"),this.currentPhase="preparation",this.loadPhaseStep(e.length-1),void this.updatePhaseIndicator()}console.log("Already at first step, cannot go back further")}catch(e){console.error("Error navigating to previous step:",e)}}updatePhaseIndicator(){console.log("Updating phase indicator to:",this.currentPhase),this.elements.phaseIndicators.forEach((e=>{const t=e.dataset.phase,n=t===this.currentPhase;e.classList.toggle("active",n),console.log(`Phase ${t} active:`,n)}))}getCurrentPhaseStepNumber(){return this.getPhaseSteps().findIndex((e=>e===this.steps[this.currentStep]))+1}getTotalPhaseSteps(){return this.steps.filter((e=>e.phase===this.currentPhase)).length}readCurrentStep(){const e=this.steps[this.currentStep];e&&this.voiceControl&&this.voiceControl.readCurrentStep(e)}readAllSteps(){this.voiceControl&&this.voiceControl.readAllSteps(this.steps)}handleVoiceCommand(e){switch(e.toLowerCase()){case"next step":this.nextStep();break;case"previous step":this.previousStep();break;case"read step":this.readCurrentStep();break;case"start timer":this.eventBus.publish("timer:request:start:all",null);break;case"read all":this.readAllSteps()}}setupVoiceCommands(){const e={"next (step)":()=>this.nextStep(),"go (to the) next (step)":()=>this.nextStep(),"go forward":()=>this.nextStep(),forward:()=>this.nextStep(),continue:()=>this.nextStep(),"previous (step)":()=>this.previousStep(),"go (to the) previous (step)":()=>this.previousStep(),"go back":()=>this.previousStep(),back:()=>this.previousStep(),"read (this) step":()=>this.readCurrentStep(),"read (the) instructions":()=>this.readCurrentStep(),"read (it) (to me)":()=>this.readCurrentStep(),"read (the current) step":()=>this.readCurrentStep(),read:()=>this.readCurrentStep(),"read step":()=>this.readCurrentStep(),"read the step":()=>this.readCurrentStep(),"pause (the) reading":()=>{this.voiceControl&&this.voiceControl.pauseReading()},"stop reading":()=>{if(this.voiceControl&&this.voiceControl.stopSpeaking()){const e=this.elements.readButton;e&&(e.classList.add("flash-feedback"),setTimeout((()=>{e.classList.remove("flash-feedback")}),300))}},"resume (the) reading":()=>{this.voiceControl&&this.voiceControl.resumeReading()},"continue reading":()=>{this.voiceControl&&this.voiceControl.resumeReading()},"go to preparation (phase)":()=>this.jumpToPhase("preparation"),"switch to preparation (phase)":()=>this.jumpToPhase("preparation"),"preparation (phase)":()=>this.jumpToPhase("preparation"),"go to cooking (phase)":()=>this.jumpToPhase("cooking"),"switch to cooking (phase)":()=>this.jumpToPhase("cooking"),"cooking (phase)":()=>this.jumpToPhase("cooking"),"start timer":()=>{this.eventBus.publish("timer:request:start:all",null)},"start timers":()=>{this.eventBus.publish("timer:request:start:all",null)},"disable voice (commands)":()=>{this.voiceControl&&(this.voiceControl.stop(),this.updateVoiceControlUI(!1))},"turn off voice (commands)":()=>{this.voiceControl&&(this.voiceControl.stop(),this.updateVoiceControlUI(!1))},"enable voice (commands)":()=>{this.voiceControl&&(this.voiceControl.start(),this.updateVoiceControlUI(!0))},"turn on voice (commands)":()=>{this.voiceControl&&(this.voiceControl.start(),this.updateVoiceControlUI(!0))},"start recipe":()=>{this.currentStep=0,this.currentPhase="preparation",this.updateStep()},"exit (the) recipe":()=>this.exitCookingMode(),"close (the) recipe":()=>this.exitCookingMode(),"complete (the) recipe":()=>this.exitCookingMode(),"what can I say":()=>this.showAvailableCommands(),"show commands":()=>this.showAvailableCommands(),"available commands":()=>this.showAvailableCommands(),help:()=>this.showAvailableCommands(),"read all (steps)":()=>this.readAllSteps()};this.voiceControl&&this.voiceControl.addCommands(e)}updateVoiceControlUI(e){this.elements.voiceToggle&&this.elements.voiceStatus&&(e?(this.elements.voiceToggle.textContent="Disable Voice Commands",this.voiceControl&&this.voiceControl.isSpeaking?this.elements.voiceStatus.textContent="Reading in progress (voice commands paused)":this.elements.voiceStatus.textContent="Voice commands ready",this.elements.voiceStatus.classList.remove("inactive"),this.elements.voiceStatus.classList.add("active")):(this.elements.voiceToggle.textContent="Enable Voice Commands",this.elements.voiceStatus.textContent="Voice commands are disabled",this.elements.voiceStatus.classList.remove("active"),this.elements.voiceStatus.classList.add("inactive")))}showAvailableCommands(){if(!this.voiceControl||!this.elements.commandsPanel)return;const e={Navigation:["next step","previous step","go to preparation phase","go to cooking phase"],Reading:["read step","read instructions","stop reading","pause reading","resume reading"],Timers:["start timer","pause timer","reset timer","create a timer for 5 minutes","start pasta timer for 10 minutes","start the sauce timer","pause the pasta timer","reset the sauce timer"],"Voice Control":["enable voice commands","disable voice commands","show commands","help"]};let t='<div class="commands-panel-inner">';t+="<h3>Voice Commands</h3>",t+='<button class="close-commands-btn">×</button>',t+='<div class="commands-grid">';for(const[n,i]of Object.entries(e))t+=`<div class="command-category">\n                <h4>${n}</h4>\n                <ul>\n                    ${i.map((e=>`<li>"${e}"</li>`)).join("")}\n                </ul>\n            </div>`;t+="</div>",t+="</div>",this.elements.commandsPanel.innerHTML=t,this.elements.commandsPanel.classList.add("active");const n=this.elements.commandsPanel.querySelector(".close-commands-btn");n&&n.addEventListener("click",(()=>{this.elements.commandsPanel.classList.remove("active")})),this.voiceControl&&this.voiceControl.isEnabled()&&this.voiceControl.speak("Here are some commands you can use.")}exitCookingMode(){try{this.voiceControl&&this.voiceControl.cleanup(),c.Ay&&(c.Ay.clearAllTimers&&c.Ay.clearAllTimers(),c.Ay.clearProcessedSteps&&c.Ay.clearProcessedSteps()),this.unbindEvents(),this.recipeId?window.location.href=`recipe-summary.html?id=${this.recipeId}`:window.location.href="/"}catch(e){console.error("Error exiting cooking mode:",e),window.location.href="/"}}showError(e){let t=document.getElementById("error-message");t||(t=document.createElement("div"),t.id="error-message",t.className="error-message",t.style.cssText="color: red; padding: 20px; background-color: #ffeeee; border: 1px solid #ffcccc; margin: 20px; font-weight: bold;",(document.querySelector("main")||document.body).prepend(t)),t.textContent=e,t.style.display="block"}_runTimerTests(){console.log("Running timer tests...");try{Promise.resolve().then(r.bind(r,165)).then((e=>{e.runTimerTests(),console.log("Timer tests started successfully")})).catch((e=>{console.error("Error loading timer tests:",e)}))}catch(e){console.error("Error running timer tests:",e)}}getPhaseSteps(e){const t=e||this.currentPhase;return this.steps.filter((e=>e.phase===t))}loadPhaseStep(e){try{console.log(`Loading phase step: ${e} for phase: ${this.currentPhase}`);const t=this.getPhaseSteps();if(!t||0===t.length)return void console.error(`No steps found for ${this.currentPhase} phase.`);console.log(`Phase ${this.currentPhase} has ${t.length} steps`);const n=Math.max(0,Math.min(e,t.length-1));n!==e&&console.log(`Adjusted step number from ${e} to ${n} to stay within bounds`);const i=t[n];if(!i)return void console.error(`Step ${n} not found in ${this.currentPhase} phase.`);const r=this.steps.findIndex((e=>e===i));if(-1===r)return void console.error("Step not found in overall steps array");console.log(`Found step at index ${r} in overall steps array`),this.currentStep=r,this.updateStepDisplay(i),this.updateProgressIndicators(),this.lastUsedStepId=i.id,this.voiceControl&&this.voiceControl.isEnabled()&&this.voiceControl.playCommandRecognizedSound()}catch(e){console.error("Error loading phase step:",e)}}updateProgressIndicators(){try{if(this.elements.progressBar){const e=this.calculateProgress();this.elements.progressBar.style.width=`${e}%`}}catch(e){console.error("Error updating progress indicators:",e)}}calculateProgress(){const e=this.steps?this.steps.length:0;return 0===e?0:(this.currentStep+1)/e*100}updateStepDisplay(e){if(!e)return void console.error("No step provided to updateStepDisplay");const t=this.steps.findIndex((t=>t.id===e.id||t.description===e.description&&t.phase===e.phase));if(-1!==t){this.currentStep=t;const n=this.getCurrentPhaseStepNumber(),i="preparation"===this.currentPhase?"Preparation":"Cooking";this.elements.stepTitle.textContent=`${i} Step ${n}`,this.elements.stepNumber.textContent=`Step ${n} of ${this.getTotalPhaseSteps()}`,this.elements.currentStep.textContent=e.description,e.bullets&&e.bullets.length>0?this.elements.stepDetails.innerHTML=e.bullets.map((e=>`<li>${e}</li>`)).join(""):this.elements.stepDetails.innerHTML="",this.updatePhaseIndicator(),this.elements.prevButton.disabled=0===this.currentStep,this.currentStep===this.steps.length-1?(this.elements.nextButton.textContent="Bon Appétit!",this.elements.nextButton.disabled=!0,this.elements.nextButton.classList.add("bon-appetit")):(this.elements.nextButton.textContent="Next Step",this.elements.nextButton.disabled=!1,this.elements.nextButton.classList.remove("bon-appetit")),"function"==typeof c.Ay.highlightStep&&c.Ay.highlightStep(this.currentStep),this.checkStepForTimers(e)}else console.error("Step not found in steps array:",e)}showRecipeSummary(){try{console.log("Showing recipe summary"),this.elements.currentStep&&(this.elements.currentStep.textContent="Congratulations! You have completed all steps."),this.elements.stepDetails&&(this.elements.stepDetails.innerHTML='<li>Your recipe is ready to enjoy!</li><li>Click "Exit Cooking Mode" to return to the recipe.</li>'),this.elements.stepTitle&&(this.elements.stepTitle.textContent="Recipe Complete"),this.elements.stepNumber&&(this.elements.stepNumber.textContent=""),this.elements.nextButton&&(this.elements.nextButton.textContent="Bon Appétit!",this.elements.nextButton.disabled=!0,this.elements.nextButton.classList.add("bon-appetit"));const e=document.createElement("div");e.className="congratulations-message",e.innerHTML=`\n                <h2>Bon Appétit!</h2>\n                <p>You've completed "${this.recipe?.title}"</p>\n            `,e.style.cssText="text-align: center; margin: 20px 0; padding: 15px; background-color: #f8f5e6; border-radius: 8px; border: 1px solid #e6dfc3;";const t=document.querySelector(".step-container");t&&t.parentNode&&t.parentNode.insertBefore(e,t)}catch(e){console.error("Error showing recipe summary:",e)}}},T=(e={})=>k.init(e);window.__cookingModeInitialized=window.__cookingModeInitialized||!1,"undefined"==typeof window||window.__cookingModeInitialized||(window.__cookingModeInitialized=!0,document.addEventListener("DOMContentLoaded",(()=>{console.log("Auto-initializing cooking mode as entry point"),T()})))})();